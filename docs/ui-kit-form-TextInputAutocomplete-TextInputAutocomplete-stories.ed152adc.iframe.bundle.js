"use strict";(self.webpackChunkpass_culture_pro=self.webpackChunkpass_culture_pro||[]).push([[84],{"./src/ui-kit/form/TextInputAutocomplete/TextInputAutocomplete.stories.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{WithLabel:function(){return WithLabel},WithoutLabel:function(){return WithoutLabel},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return TextInputAutocomplete_stories}});var regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),formik_esm=__webpack_require__("./node_modules/formik/dist/formik.esm.js"),react=__webpack_require__("./node_modules/react/index.js"),index_esm=__webpack_require__("./node_modules/yup/index.esm.js"),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),getLabelString=__webpack_require__("./src/utils/getLabelString.ts"),shared=__webpack_require__("./src/ui-kit/form/shared/index.ts"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),TextInputAutocomplete_module=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/ui-kit/form/TextInputAutocomplete/TextInputAutocomplete.module.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(TextInputAutocomplete_module.Z,options);var TextInputAutocomplete_TextInputAutocomplete_module=TextInputAutocomplete_module.Z&&TextInputAutocomplete_module.Z.locals?TextInputAutocomplete_module.Z.locals:void 0,jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),AutocompleteTextInput=function AutocompleteTextInput(_ref){var className=_ref.className,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,name=_ref.name,getSuggestions=_ref.getSuggestions,_ref$hideFooter=_ref.hideFooter,hideFooter=void 0!==_ref$hideFooter&&_ref$hideFooter,_ref$isOptional=_ref.isOptional,isOptional=void 0!==_ref$isOptional&&_ref$isOptional,label=_ref.label,_ref$maxHeight=_ref.maxHeight,maxHeight=void 0===_ref$maxHeight?100:_ref$maxHeight,onSelectCustom=_ref.onSelectCustom,_ref$smallLabel=_ref.smallLabel,smallLabel=void 0!==_ref$smallLabel&&_ref$smallLabel,placeholder=_ref.placeholder,_ref$useDebounce=_ref.useDebounce,useDebounce=void 0!==_ref$useDebounce&&_ref$useDebounce,_useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),suggestions=_useState2[0],setSuggestions=_useState2[1],_useState3=(0,react.useState)(!1),_useState4=(0,slicedToArray.Z)(_useState3,2),isOpen=_useState4[0],setIsOpen=_useState4[1],_useState5=(0,react.useState)(!1),_useState6=(0,slicedToArray.Z)(_useState5,2),isFocus=_useState6[0],setIsFocus=_useState6[1],containerRef=(0,react.useRef)(null),_useField=(0,formik_esm.U$)(name),_useField2=(0,slicedToArray.Z)(_useField,3),field=_useField2[0],meta=_useField2[1],helpers=_useField2[2],_useField3=(0,formik_esm.U$)({name:"search-".concat(name)}),searchField=(0,slicedToArray.Z)(_useField3,1)[0],_useState7=(0,react.useState)(),_useState8=(0,slicedToArray.Z)(_useState7,2),lastSelectedValue=_useState8[0],setLastSelectedValue=_useState8[1],_useFormikContext=(0,formik_esm.u6)(),setFieldValue=_useFormikContext.setFieldValue,setFieldTouched=_useFormikContext.setFieldTouched,updateSuggestions=(0,react.useCallback)(function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(search){var suggestions;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,getSuggestions(search);case 2:(suggestions=_context.sent).length>0?(setSuggestions(suggestions),isFocus&&setIsOpen(!0)):setIsOpen(!1);case 4:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),[isFocus]),debouncedSearch=(0,react.useCallback)((0,lodash.debounce)(updateSuggestions,300),[isFocus]),handleSearchChange=(0,react.useCallback)((function(search){useDebounce?debouncedSearch(search):updateSuggestions(search),search||setIsOpen(!1),setFieldValue("search-".concat(name),search,!1)}),[updateSuggestions,debouncedSearch]),updateFieldWithSelectedItem=function updateFieldWithSelectedItem(selectedItem){onSelectCustom&&selectedItem&&onSelectCustom(selectedItem),helpers.setValue((null==selectedItem?void 0:selectedItem.label)||""),setFieldValue("search-".concat(name),(null==selectedItem?void 0:selectedItem.label)||"",!1)},handleClickOutside=(0,react.useCallback)((function(e){var _containerRef$current;null!==(_containerRef$current=containerRef.current)&&void 0!==_containerRef$current&&_containerRef$current.contains(e.target)||(!isOpen&&searchField.value||(updateFieldWithSelectedItem(lastSelectedValue),setIsOpen(!1),setFieldTouched(name)),setIsFocus(!1))}),[isOpen,lastSelectedValue,updateFieldWithSelectedItem]);return(0,react.useEffect)((function(){return containerRef.current&&document.addEventListener("mousedown",handleClickOutside),function(){document.removeEventListener("mousedown",handleClickOutside)}}),[containerRef,handleClickOutside]),(0,jsx_runtime.jsx)(shared.Q4,{label:label,name:"search-".concat(name),error:meta.error,showError:meta.touched&&!!meta.error,smallLabel:smallLabel,isOptional:isOptional,hideFooter:hideFooter,className:className,children:(0,jsx_runtime.jsxs)("div",{className:classnames_default()(TextInputAutocomplete_TextInputAutocomplete_module["input-autocomplete-container"],className),ref:containerRef,children:[(0,jsx_runtime.jsx)(shared.Qc,(0,objectSpread2.Z)((0,objectSpread2.Z)({onFocus:function onFocus(){setIsFocus(!0),suggestions.length>0&&setIsOpen(!0)},placeholder:null!=placeholder?placeholder:(0,getLabelString.F)(label),hasError:meta.touched&&!!meta.error,type:"text",disabled:disabled,className:TextInputAutocomplete_TextInputAutocomplete_module["select-autocomplete-input"],autoComplete:"off"},searchField),{},{onChange:function onChange(e){return handleSearchChange(e.target.value)}})),(0,jsx_runtime.jsx)(shared.yN,{className:TextInputAutocomplete_TextInputAutocomplete_module.menu,filteredOptions:suggestions,hideArrow:!0,isOpen:isOpen,maxHeight:maxHeight,onButtonClick:function onButtonClick(){},renderOption:function renderSuggestion(item,disabled){return(0,jsx_runtime.jsx)(shared.Cn,{label:item.label,className:classnames_default()(TextInputAutocomplete_TextInputAutocomplete_module.option,(0,defineProperty.Z)({},TextInputAutocomplete_TextInputAutocomplete_module["option-disabled"],disabled)),value:item.label,id:"".concat(name,"-").concat(item.value),name:"".concat(name,"-").concat(item.value),role:"option","aria-selected":field.value===item.label,disabled:disabled,checked:field.value===item.value,onClick:function onClick(){return function handleSelect(selectedItem){setLastSelectedValue(selectedItem),updateFieldWithSelectedItem(selectedItem),setIsOpen(!1),setIsFocus(!1)}(item)},readOnly:!0},"".concat(name,"-").concat(item.value))}})]})})};AutocompleteTextInput.displayName="AutocompleteTextInput";var TextInputAutocomplete=AutocompleteTextInput,TextInputAutocomplete_stories={title:"ui-kit/forms/TextInputAutocomplete",component:TextInputAutocomplete},getSuggestions=function(){var _ref=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(){return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",[{value:"1",label:"12 rue des étoiles - 75000 - Paris"},{value:"2",label:"19 rue de la république - 69000 - Lyon"},{value:"3",label:"43 rue des fleurs - 13000 - Marseille"}]);case 1:case"end":return _context.stop()}}),_callee)})));return function getSuggestions(){return _ref.apply(this,arguments)}}(),validationSchema=index_esm.Ry().shape({adress:index_esm.Z_().required("Veuillez renseigner une adresse")}),Template=function Template(_ref2){var label=_ref2.label;return(0,jsx_runtime.jsx)(formik_esm.J9,{initialValues:{adress:"","search-adress":""},onSubmit:function onSubmit(){},validationSchema:validationSchema,children:(0,jsx_runtime.jsx)(TextInputAutocomplete,{getSuggestions:getSuggestions,label:label,name:"adress",placeholder:"input placeholder"})})};Template.displayName="Template";var WithoutLabel=Template.bind({}),WithLabel=Template.bind({});WithLabel.args={label:"Adresse"};var __namedExportsOrder=["WithoutLabel","WithLabel"]},"./src/utils/getLabelString.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{F:function(){return getLabelString}});var getLabelString=function getLabelString(label){return"string"==typeof label?label:""}},"./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/ui-kit/form/TextInputAutocomplete/TextInputAutocomplete.module.scss":function(module,__webpack_exports__,__webpack_require__){var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".A8fFx3gcIp8V0v8cMx7Q{box-sizing:border-box;position:relative;width:100%}.A8fFx3gcIp8V0v8cMx7Q .LuyQ5lW1n1cvBfSzMkNs input[type=checkbox]{opacity:0}.A8fFx3gcIp8V0v8cMx7Q .qYmt7d9Q9qQ_afbrL3S2:hover{background-color:#fff}.A8fFx3gcIp8V0v8cMx7Q .LuyQ5lW1n1cvBfSzMkNs span{position:absolute}","",{version:3,sources:["webpack://./src/ui-kit/form/TextInputAutocomplete/TextInputAutocomplete.module.scss"],names:[],mappings:"AAAA,sBACE,qBAAA,CACA,iBAAA,CACA,UAAA,CAGE,iEACE,SAAA,CAGF,kDACE,qBAAA,CAGF,iDACE,iBAAA",sourcesContent:['.input-autocomplete-container {\n  box-sizing: border-box;\n  position: relative;\n  width: 100%;\n\n  .option {\n    input[type="checkbox"] {\n      opacity: 0;\n    }\n\n    &-disabled:hover {\n      background-color: white;\n    }\n\n    span {\n      position: absolute;\n    }\n  }\n}\n'],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={"input-autocomplete-container":"A8fFx3gcIp8V0v8cMx7Q",option:"LuyQ5lW1n1cvBfSzMkNs","option-disabled":"qYmt7d9Q9qQ_afbrL3S2"},__webpack_exports__.Z=___CSS_LOADER_EXPORT___}}]);