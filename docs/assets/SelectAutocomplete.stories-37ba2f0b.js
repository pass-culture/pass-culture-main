import{j as l}from"./jsx-runtime-ffb262ed.js";import{a as ve,c as Q,b as _e}from"./formik.esm-5489b507.js";import{c as w}from"./index-a587463d.js";import{r as f}from"./index-76fb7be0.js";import{F as Ve,g as qe}from"./Thumb-4858970c.js";import{B as Oe,b as xe}from"./BaseCheckbox-58c59efd.js";import"./BaseFileInput-5547a44b.js";import{c as Le}from"./stroke-show-b083c009.js";import"./FieldError-0089fdbc.js";import"./FieldSuccess-31bdacb0.js";import{T as Ne}from"./Tag-2c2f8155.js";import{S as Se}from"./SvgIcon-c0bf369c.js";import{B as Ae}from"./BaseInput-be025c1d.js";import"./_commonjsHelpers-de833af9.js";import"./hoist-non-react-statics.cjs-3f8ebaa8.js";import"./full-next-ebff3494.js";import"./Button-cb282eb8.js";import"./index-e9b1af40.js";import"./full-right-83efe067.js";import"./stroke-pass-cf331655.js";import"./Tooltip-89401960.js";import"./BaseRadio-dfa7f1ae.js";import"./full-clear-9268779e.js";import"./Divider-7c035ea9.js";import"./SubmitButton-f5515d1b.js";import"./index-9d475cdf.js";import"./typeof-7fd5df1e.js";import"./utils-70f14cd5.js";import"./Banner-e4ca9983.js";import"./shadow-tips-help-841f916a.js";import"./shadow-tips-warning-66fb0429.js";import"./stroke-close-3a7bfe9e.js";import"./LinkNodes-3ac34a43.js";import"./full-link-9eb5e1cb.js";import"./InfoBox-4f0aee06.js";import"./stroke-error-ed5fe82d.js";import"./stroke-valid-9c345a33.js";const X=e=>e.trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Fe=(e,o,t)=>{const s=[];for(let u=0;u<e.length&&!(t&&s.length>=t);u++){const d=e[u].normalizedLabel??X(e[u].label);X(o||"").split(" ").every(v=>d.includes(v))&&s.push(e[u])}return s},ke="_menu_qqt91_2",Ie="_label_qqt91_21",E={menu:ke,"menu--no-results":"_menu--no-results_qqt91_17",label:Ie,"option-hovered":"_option-hovered_qqt91_34"},H=({className:e,fieldName:o,selectedValues:t,filteredOptions:s,setHoveredOptionIndex:u,listRef:d,hoveredOptionIndex:A,selectOption:v,multi:F})=>l.jsxs("div",{className:w(E.menu,e),role:"listbox",children:[s.length===0&&l.jsx("span",{className:w({[E["menu--no-results"]]:s.length===0}),children:"Aucun résultat"}),l.jsx("ul",{"data-testid":"list",id:`list-${o}`,ref:d,role:"listbox",children:s.map(({value:i,label:p},_)=>{const V=(t||[]).includes(String(i));return l.jsx("li",{"aria-selected":V,"aria-posinset":_+1,"aria-setsize":s.length,className:A===_?E["option-hovered"]:"","data-value":i,"data-selected":V,id:`option-display-${i}`,onMouseEnter:()=>u(_),role:"option",tabIndex:-1,children:F?l.jsx(Oe,{label:p,checked:V,onChange:()=>{v(String(i))}}):l.jsx("span",{onClick:()=>{v(String(i))},className:w(xe["base-checkbox-label"],E.label),children:p})},`option-display-${i}`)})})]});try{H.displayName="OptionsList",H.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[] | null"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}try{OptionsList.displayName="OptionsList",OptionsList.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[] | null"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}const $e="_pellet_sn75o_16",x={"multi-select-autocomplete-container":"_multi-select-autocomplete-container_sn75o_2","multi-select-autocomplete-placeholder-input":"_multi-select-autocomplete-placeholder-input_sn75o_8","field-overlay":"_field-overlay_sn75o_12",pellet:$e,"visually-hidden":"_visually-hidden_sn75o_34"},je={"multi-select-autocomplete-tags":"_multi-select-autocomplete-tags_1exsd_1"},B=({disabled:e,fieldName:o,optionsLabelById:t,selectedOptions:s,removeOption:u})=>l.jsx("div",{className:je["multi-select-autocomplete-tags"],children:s.map(d=>l.jsx(Ne,{label:t[d],closeable:{closeLabel:"Supprimer "+t[d],onClose:()=>{u(d)},disabled:e}},`tag-${o}-${d}`))});try{B.displayName="Tags",B.__docgenInfo={description:"",displayName:"Tags",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},optionsLabelById:{defaultValue:null,description:"",name:"optionsLabelById",required:!0,type:{name:"Record<string, string>"}},selectedOptions:{defaultValue:null,description:"",name:"selectedOptions",required:!0,type:{name:"string[]"}},removeOption:{defaultValue:null,description:"",name:"removeOption",required:!0,type:{name:"(value: string) => void"}}}}}catch{}const Te={"dropdown-indicator":"_dropdown-indicator_1fr35_2"},D=({disabled:e,isOpen:o,toggleField:t})=>l.jsx("button",{onClick:t,className:Te["dropdown-indicator"],type:"button",disabled:e,children:l.jsx(Se,{src:Le,alt:`${o?"Masquer":"Afficher"} les options`,width:"20"})});try{D.displayName="Toggle",D.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}try{Toggle.displayName="Toggle",Toggle.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}const M=({className:e,disabled:o=!1,name:t,hideArrow:s,hideFooter:u=!1,hideTags:d=!1,inline:A,isOptional:v=!1,label:F,multi:i=!1,options:p,placeholder:_,pluralLabel:V,smallLabel:oe=!1,resetOnOpen:ue=!0,description:de,onSearch:z=()=>{},searchInOptions:pe=k=>k,onReset:ce=()=>{},type:me="text",leftIcon:U})=>{var G;const{setFieldTouched:k,setFieldValue:O}=ve(),[a,I]=Q(t),[b,fe]=Q(`search-${t}`),[c,g]=f.useState(null),[$,ge]=f.useState({}),j=f.useRef(null),T=f.useRef(null),[m,y]=f.useState(!1),[q,ye]=f.useState(p);f.useEffect(()=>{m&&ue&&b.value!==""&&(O(`search-${t}`,"",!1),O(t,"",!1),ce())},[m]),f.useEffect(()=>{ge(p.reduce((n,r)=>(n[r.value]=r.label,n),{}))},[p]),f.useEffect(()=>{const n=r=>{var h;(h=j.current)!=null&&h.contains(r.target)||y(!1)};return j.current&&document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[j]),f.useEffect(()=>{z&&z(b.value.trim()),g(null)},[b.value]),f.useEffect(()=>{ye(pe(p,b.value))},[b.value,p]);const be=n=>{var r,h,J;switch(n.key){case"ArrowUp":c!==null&&(c<=0?g(null):g(c-1)),m||y(!0),(r=T.current)==null||r.focus();break;case"ArrowDown":c===null?g(0):c>=q.length-1?g(q.length-1):g(c+1),m||y(!0),(h=T.current)==null||h.focus();break;case"Space":K(),(J=T.current)==null||J.focus();break;case"Enter":m&&c!==null&&(n.preventDefault(),R(String(q[c].value)));break;case"Escape":g(null),y(!1);break;case"Tab":g(null),y(!1);break}},R=n=>{let r;i?a.value.includes(n)&&Array.isArray(a.value)?r=a.value.filter(h=>h!==n):r=[...a.value,n]:(r=n,y(!1),g(null),O(`search-${t}`,$[r],!1)),O(t,r)},K=()=>{m||y(!0),k(t,!0)},W=()=>{m?(y(!1),O(`search-${t}`,"",!1)):y(!0),k(t,!0)},he=Array.isArray(a.value)?_??(a.value.length>1&&V?V:F):_??$[a.value];return l.jsxs(Ve,{className:e,error:I.error,hideFooter:!d&&u,isOptional:v,label:F,name:`search-${t}`,showError:I.touched&&!!I.error,smallLabel:oe,inline:A,description:de,children:[l.jsxs("div",{className:w(x["multi-select-autocomplete-container"],e),onKeyDown:be,ref:j,children:[l.jsx(Ae,{...c!==null&&{"aria-activedescendant":`option-display-${(G=q[c])==null?void 0:G.value}`},onFocus:K,placeholder:qe(he),style:{paddingLeft:i&&a.value.length>0||U?"2.2rem":"1rem"},className:x["multi-select-autocomplete-placeholder-input"],hasError:fe.touched&&!!I.error,type:me,disabled:o,...b,"aria-autocomplete":"list","aria-controls":`list-${t}`,"aria-describedby":`help-${t}`,"aria-expanded":m,"aria-haspopup":"listbox",role:"combobox",leftIcon:U}),l.jsxs("div",{"aria-live":"polite","aria-relevant":"text",className:x["visually-hidden"],id:`help-${t}`,children:[i&&`${a.value.length} options sélectionnées`,!i&&!Array.isArray(a.value)&&a.value!==""&&`Option sélectionnée : ${$[a.value]}`,m?`${q.length} options ${b.value===""?"disponibles":"correspondant au texte saisi"}`:"saisissez du texte pour afficher et filtrer les options"]}),l.jsx("select",{hidden:!0,...i&&{multiple:!0},...a,value:a.value||"","data-testid":"select",children:p==null?void 0:p.map(({label:n,value:r})=>l.jsx("option",{value:r,children:n},`option-${r}`))}),l.jsxs("div",{className:x["field-overlay"],children:[!s&&l.jsx(D,{disabled:o,isOpen:m,toggleField:W}),i&&a.value.length>0&&l.jsx("div",{onClick:W,className:x.pellet,children:a.value.length}),m&&l.jsx(H,{className:e,fieldName:t,selectedValues:a.value,filteredOptions:q,setHoveredOptionIndex:g,listRef:T,hoveredOptionIndex:c,selectOption:R,multi:i})]})]}),Array.isArray(a.value)&&!d&&a.value.length>0&&l.jsx(B,{disabled:o,fieldName:t,optionsLabelById:$,selectedOptions:a.value,removeOption:R})]})},se=M;try{M.displayName="SelectAutocomplete",M.__docgenInfo={description:"",displayName:"SelectAutocomplete",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},isLabelHidden:{defaultValue:null,description:"",name:"isLabelHidden",required:!1,type:{name:"boolean"}},hasLabelLineBreak:{defaultValue:null,description:"",name:"hasLabelLineBreak",required:!1,type:{name:"boolean"}},isOptional:{defaultValue:{value:"false"},description:"",name:"isOptional",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},classNameLabel:{defaultValue:null,description:"",name:"classNameLabel",required:!1,type:{name:"string"}},classNameFooter:{defaultValue:null,description:"",name:"classNameFooter",required:!1,type:{name:"string"}},filterVariant:{defaultValue:null,description:"",name:"filterVariant",required:!1,type:{name:"boolean"}},smallLabel:{defaultValue:{value:"false"},description:"",name:"smallLabel",required:!1,type:{name:"boolean"}},hideFooter:{defaultValue:{value:"false"},description:"",name:"hideFooter",required:!1,type:{name:"boolean"}},inline:{defaultValue:null,description:"",name:"inline",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"",name:"clearButtonProps",required:!1,type:{name:"(ButtonHTMLAttributes<HTMLButtonElement> & { tooltip: string; })"}},ErrorDetails:{defaultValue:null,description:"",name:"ErrorDetails",required:!1,type:{name:"ReactNode"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},hideArrow:{defaultValue:null,description:"",name:"hideArrow",required:!1,type:{name:"boolean"}},hideTags:{defaultValue:{value:"false"},description:"",name:"hideTags",required:!1,type:{name:"boolean"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},multi:{defaultValue:{value:"false"},description:"",name:"multi",required:!1,type:{name:"boolean"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"SelectOption[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},pluralLabel:{defaultValue:null,description:"",name:"pluralLabel",required:!1,type:{name:"string"}},resetOnOpen:{defaultValue:{value:"true"},description:"",name:"resetOnOpen",required:!1,type:{name:"boolean"}},onSearch:{defaultValue:{value:"() => {}"},description:"",name:"onSearch",required:!1,type:{name:"((pattern: string) => void)"}},searchInOptions:{defaultValue:{value:"options => options"},description:"",name:"searchInOptions",required:!1,type:{name:"((options: SelectOption[], pattern: string) => SelectOption[])"}},onReset:{defaultValue:{value:"() => {}"},description:"",name:"onReset",required:!1,type:{name:"(() => void)"}},type:{defaultValue:{value:"text"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"search"'},{value:'"text"'}]}},leftIcon:{defaultValue:null,description:"",name:"leftIcon",required:!1,type:{name:"string"}}}}}catch{}const ht={title:"ui-kit/forms/SelectAutocomplete",component:se},C=e=>l.jsx(_e,{initialValues:e.initialValues,onSubmit:()=>{},children:l.jsx(se,{...e})}),P={pluralLabel:"Départements",name:"departement",options:[{value:"01",label:"Ain"},{value:"02",label:"Aisne"},{value:"03",label:"Allier"},{value:"04",label:"Alpes-de-Haute-Provence test de libellé très long"},{value:"05",label:"Hautes-Alpes"},{value:"06",label:"Alpes-Maritimes"},{value:"07",label:"Ardèche"},{value:"08",label:"Ardennes"},{value:"09",label:"Ariège"},{value:"10",label:"Aube"},{value:"11",label:"Aude"},{value:"12",label:"Aveyron"},{value:"13",label:"Bouches-du-Rhône"},{value:"14",label:"Calvados"},{value:"15",label:"Cantal"}],initialValues:{departement:"01"},label:"Département",hideFooter:!1,hideTags:!1,isOptional:!1,smallLabel:!1,searchInOptions:Fe},L=C.bind({});L.args=P;const N=C.bind({});N.args={...P,multi:!0,initialValues:{departement:["01","02"]}};const S=C.bind({});S.args={...P,multi:!0,initialValues:{departement:["01","02"]},hideTags:!0};var Y,Z,ee;L.parameters={...L.parameters,docs:{...(Y=L.parameters)==null?void 0:Y.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(ee=(Z=L.parameters)==null?void 0:Z.docs)==null?void 0:ee.source}}};var te,le,ae;N.parameters={...N.parameters,docs:{...(te=N.parameters)==null?void 0:te.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(ae=(le=N.parameters)==null?void 0:le.docs)==null?void 0:ae.source}}};var re,ne,ie;S.parameters={...S.parameters,docs:{...(re=S.parameters)==null?void 0:re.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(ie=(ne=S.parameters)==null?void 0:ne.docs)==null?void 0:ie.source}}};const vt=["Default","Multi","WithoutTags"];export{L as Default,N as Multi,S as WithoutTags,vt as __namedExportsOrder,ht as default};
//# sourceMappingURL=SelectAutocomplete.stories-37ba2f0b.js.map
