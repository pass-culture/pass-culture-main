{"version":3,"file":"AdageButtonFilter.stories-b16950cb.js","sources":["../../src/components/AdageButtonFilter/AdageButtonFilter.tsx"],"sourcesContent":["import cn from 'classnames'\nimport React, { useCallback, useEffect, useRef, useState } from 'react'\n\nimport fullDownIcon from 'icons/full-down.svg'\nimport fullUpIcon from 'icons/full-up.svg'\nimport { SvgIcon } from 'ui-kit/SvgIcon/SvgIcon'\n\nimport styles from './AdageButtonFilter.module.scss'\n\nexport interface AdageButtonFilterProps\n  extends React.HTMLProps<HTMLButtonElement> {\n  title: string\n  isActive: boolean\n  itemsLength?: number | null\n  isOpen: boolean\n  setIsOpen: React.Dispatch<React.SetStateAction<{ [key: string]: boolean }>>\n  filterName: string\n  handleSubmit: () => void\n}\n\nconst AdageButtonFilter = ({\n  title,\n  children,\n  isActive,\n  disabled,\n  itemsLength,\n  isOpen,\n  setIsOpen,\n  filterName,\n  handleSubmit,\n}: AdageButtonFilterProps): JSX.Element => {\n  const [dialogLeftOffset, setDialogLeftOffset] = useState(0)\n  const containerRef = useRef<HTMLDivElement | null>(null)\n  const dialogRef = useRef<HTMLDialogElement | null>(null)\n\n  useEffect(() => {\n    const containerElm = containerRef.current\n    const dialogElm = dialogRef.current\n\n    //  Only reposition when opening the dialog\n    if (!isOpen || !containerElm || !dialogElm) {\n      return\n    }\n\n    //  Part of the dialog width that goes beyond the body width on the right\n    const dialogOutOfScreenDistance =\n      containerElm.getBoundingClientRect().left +\n      dialogElm.getBoundingClientRect().width -\n      document.body.clientWidth\n\n    setDialogLeftOffset(Math.max(dialogOutOfScreenDistance, 0))\n  }, [isOpen])\n\n  const handleClickOutside = useCallback(\n    (e: MouseEvent): void => {\n      if (!containerRef.current?.contains(e.target as Node)) {\n        if (isOpen) {\n          setIsOpen({ [filterName]: false })\n          handleSubmit()\n        }\n      }\n    },\n    [setIsOpen, handleSubmit, isOpen, filterName]\n  )\n\n  useEffect(() => {\n    if (containerRef.current) {\n      document.addEventListener('mousedown', handleClickOutside)\n    }\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside)\n    }\n  }, [containerRef, handleClickOutside])\n\n  const clickModalButtonHandler = () => {\n    setIsOpen(previousIsOpen => ({ [filterName]: !previousIsOpen[filterName] }))\n  }\n\n  return (\n    <div ref={containerRef} className={styles['adage-container']}>\n      <button\n        type=\"button\"\n        disabled={disabled}\n        onClick={clickModalButtonHandler}\n        className={cn([styles['adage-button']], {\n          [styles['adage-button-is-active']]: isActive,\n          [styles['adage-button-selected']]: isOpen,\n        })}\n      >\n        {title} {isActive && `(${itemsLength})`}\n        {!disabled && (\n          <SvgIcon\n            className={styles['adage-button-dropdown']}\n            alt=\"\"\n            src={isOpen ? fullUpIcon : fullDownIcon}\n            width=\"16\"\n          />\n        )}\n      </button>\n\n      <div className={styles['adage-button-modal']}>\n        <dialog\n          open={isOpen}\n          className={styles['adage-button-children']}\n          style={{ left: `${-dialogLeftOffset}px` }}\n          ref={dialogRef}\n        >\n          {children}\n        </dialog>\n      </div>\n    </div>\n  )\n}\n\nexport default AdageButtonFilter\n"],"names":["AdageButtonFilter","title","children","isActive","disabled","itemsLength","isOpen","setIsOpen","filterName","handleSubmit","dialogLeftOffset","setDialogLeftOffset","useState","containerRef","useRef","dialogRef","useEffect","containerElm","dialogElm","dialogOutOfScreenDistance","handleClickOutside","useCallback","e","_a","clickModalButtonHandler","previousIsOpen","jsxs","styles","cn","jsx","SvgIcon","fullUpIcon","fullDownIcon","AdageButtonFilter$1"],"mappings":"4nBAoBAA,EAAA,CAAA,CAA2B,MAAAC,EACzB,SAAAC,EACA,SAAAC,EACA,SAAAC,EACA,YAAAC,EACA,OAAAC,EACA,UAAAC,EACA,WAAAC,EACA,aAAAC,CAEF,IAAA,CACE,KAAA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,CAAA,EACAC,EAAAC,SAAA,IAAA,EACAC,EAAAD,SAAA,IAAA,EAEAE,EAAAA,UAAA,IAAA,CACE,MAAAC,EAAAJ,EAAA,QACAK,EAAAH,EAAA,QAGA,GAAA,CAAAT,GAAA,CAAAW,GAAA,CAAAC,EACE,OAIF,MAAAC,EAAAF,EAAA,sBAAA,EAAA,KAAAC,EAAA,sBAAA,EAAA,MAAA,SAAA,KAAA,YAKAP,EAAA,KAAA,IAAAQ,EAAA,CAAA,CAAA,CAA0D,EAAA,CAAAb,CAAA,CAAA,EAG5D,MAAAc,EAAAC,EAAA,YAA2BC,GAAA,QAEvBC,EAAAV,EAAA,UAAA,MAAAU,EAAA,SAAAD,EAAA,SACEhB,IACEC,EAAA,CAAA,CAAAC,CAAA,EAAA,EAAA,CAAA,EACAC,IAEJ,EACF,CAAAF,EAAAE,EAAAH,EAAAE,CAAA,CAC4C,EAG9CQ,EAAAA,UAAA,KACEH,EAAA,SACE,SAAA,iBAAA,YAAAO,CAAA,EAEF,IAAA,CACE,SAAA,oBAAA,YAAAA,CAAA,CAA4D,GAC9D,CAAAP,EAAAO,CAAA,CAAA,EAGF,MAAAI,EAAA,IAAA,CACEjB,EAAAkB,IAAA,CAAA,CAAAjB,CAAA,EAAA,CAAAiB,EAAAjB,CAAA,CAAA,EAAA,CAA2E,EAG7E,OAAAkB,EAAA,KAAA,MAAA,CAAA,IAAAb,EAAA,UAAAc,EAAA,iBAAA,EAAA,SAAA,CAEID,EAAA,KAAA,SAAC,CAAA,KAAA,SACM,SAAAtB,EACL,QAAAoB,EACS,UAAAI,EAAA,CAAAD,EAAA,cAAA,CAAA,EAAA,CAC+B,CAAAA,EAAA,wBAAA,CAAA,EAAAxB,EACF,CAAAwB,EAAA,uBAAA,CAAA,EAAArB,CACD,CAAA,EACpC,SAAA,CAEAL,EAAA,IAAME,GAAA,IAAAE,CAAA,IAA6B,CAAAD,GAAAyB,EAAA,IAElCC,EAAC,CAAA,UAAAH,EAAA,uBAAA,EAC0C,IAAA,GACrC,IAAArB,EAAAyB,EAAAC,EACuB,MAAA,IACrB,CAAA,CACR,CAAA,CAAA,EAEJH,EAAA,IAAA,MAAA,CAAA,UAAAF,EAAA,oBAAA,EAAA,SAAAE,EAAA,IAGE,SAAC,CAAA,KAAAvB,EACO,UAAAqB,EAAA,uBAAA,EACmC,MAAA,CAAA,KAAA,GAAA,CAAAjB,CAAA,IAAA,EACD,IAAAK,EACnC,SAAAb,CAEJ,CAAA,EAAA,CAEL,CAAA,CAAA,CAGN,EAEA+B,EAAAjC"}