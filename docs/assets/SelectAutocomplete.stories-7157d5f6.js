import{j as l}from"./jsx-runtime-ffb262ed.js";import{a as he,c as J,b as ve}from"./formik.esm-d2c4e539.js";import{c as w}from"./index-a587463d.js";import{r as c}from"./index-76fb7be0.js";import{F as _e,g as Ve}from"./Thumb-7874c198.js";import{B as qe,b as Oe}from"./BaseCheckbox-58c59efd.js";import"./BaseFileInput-5547a44b.js";import{c as xe}from"./stroke-show-3f94b3ba.js";import"./FieldError-0089fdbc.js";import"./FieldSuccess-31bdacb0.js";import{T as Ne}from"./Tag-2c2f8155.js";import{S as Le}from"./SvgIcon-c0bf369c.js";import{B as Se}from"./BaseInput-be025c1d.js";import"./_commonjsHelpers-de833af9.js";import"./hoist-non-react-statics.cjs-3f8ebaa8.js";import"./full-next-ebff3494.js";import"./Button-f4291fcc.js";import"./index-76bbc159.js";import"./full-right-83efe067.js";import"./stroke-pass-cf331655.js";import"./Tooltip-8ef95996.js";import"./BaseRadio-dfa7f1ae.js";import"./full-clear-9268779e.js";import"./Divider-7c035ea9.js";import"./SubmitButton-8608fd59.js";import"./index-9d475cdf.js";import"./typeof-7fd5df1e.js";import"./utils-70f14cd5.js";import"./Banner-fc3142eb.js";import"./shadow-tips-help-841f916a.js";import"./shadow-tips-warning-66fb0429.js";import"./stroke-close-3a7bfe9e.js";import"./LinkNodes-c39eda54.js";import"./full-link-9eb5e1cb.js";import"./InfoBox-d99b859d.js";import"./stroke-error-ed5fe82d.js";import"./stroke-valid-9c345a33.js";const Q=t=>t.trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Ae=(t,s,e)=>t.filter(y=>{const o=Q(y.label);return Q(s||"").split(" ").every(q=>o.includes(q))}).slice(0,e??t.length),Fe="_menu_qqt91_2",ke="_label_qqt91_21",E={menu:Fe,"menu--no-results":"_menu--no-results_qqt91_17",label:ke,"option-hovered":"_option-hovered_qqt91_34"},H=({className:t,fieldName:s,selectedValues:e,filteredOptions:f,setHoveredOptionIndex:y,listRef:o,hoveredOptionIndex:q,selectOption:A,multi:F})=>l.jsxs("div",{className:w(E.menu,t),role:"listbox",children:[f.length===0&&l.jsx("span",{className:w({[E["menu--no-results"]]:f.length===0}),children:"Aucun résultat"}),l.jsx("ul",{"data-testid":"list",id:`list-${s}`,ref:o,role:"listbox",children:f.map(({value:i,label:u},v)=>{const _=(e||[]).includes(String(i));return l.jsx("li",{"aria-selected":_,"aria-posinset":v+1,"aria-setsize":f.length,className:q===v?E["option-hovered"]:"","data-value":i,"data-selected":_,id:`option-display-${i}`,onMouseEnter:()=>y(v),role:"option",tabIndex:-1,children:F?l.jsx(qe,{label:u,checked:_,onChange:()=>{A(String(i))}}):l.jsx("span",{onClick:()=>{A(String(i))},className:w(Oe["base-checkbox-label"],E.label),children:u})},`option-display-${i}`)})})]});try{H.displayName="OptionsList",H.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[] | null"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}try{OptionsList.displayName="OptionsList",OptionsList.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[] | null"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}const Ie="_pellet_sn75o_16",x={"multi-select-autocomplete-container":"_multi-select-autocomplete-container_sn75o_2","multi-select-autocomplete-placeholder-input":"_multi-select-autocomplete-placeholder-input_sn75o_8","field-overlay":"_field-overlay_sn75o_12",pellet:Ie,"visually-hidden":"_visually-hidden_sn75o_34"},$e={"multi-select-autocomplete-tags":"_multi-select-autocomplete-tags_1exsd_1"},B=({disabled:t,fieldName:s,optionsLabelById:e,selectedOptions:f,removeOption:y})=>l.jsx("div",{className:$e["multi-select-autocomplete-tags"],children:f.map(o=>l.jsx(Ne,{label:e[o],closeable:{closeLabel:"Supprimer "+e[o],onClose:()=>{y(o)},disabled:t}},`tag-${s}-${o}`))});try{B.displayName="Tags",B.__docgenInfo={description:"",displayName:"Tags",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},optionsLabelById:{defaultValue:null,description:"",name:"optionsLabelById",required:!0,type:{name:"Record<string, string>"}},selectedOptions:{defaultValue:null,description:"",name:"selectedOptions",required:!0,type:{name:"string[]"}},removeOption:{defaultValue:null,description:"",name:"removeOption",required:!0,type:{name:"(value: string) => void"}}}}}catch{}const je={"dropdown-indicator":"_dropdown-indicator_1fr35_2"},D=({disabled:t,isOpen:s,toggleField:e})=>l.jsx("button",{onClick:e,className:je["dropdown-indicator"],type:"button",disabled:t,children:l.jsx(Le,{src:xe,alt:`${s?"Masquer":"Afficher"} les options`,width:"20"})});try{D.displayName="Toggle",D.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}try{Toggle.displayName="Toggle",Toggle.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}const C=({className:t,disabled:s=!1,name:e,hideArrow:f,hideFooter:y=!1,hideTags:o=!1,inline:q,isOptional:A=!1,label:F,multi:i=!1,options:u,placeholder:v,pluralLabel:_,smallLabel:se=!1,resetOnOpen:oe=!0,description:ue,onSearch:P=()=>{},searchInOptions:de=k=>k,onReset:pe=()=>{},type:ce="text"})=>{var W;const{setFieldTouched:k,setFieldValue:O}=he(),[a,I]=J(e),[b,me]=J(`search-${e}`),[d,m]=c.useState(null),[$,fe]=c.useState({}),j=c.useRef(null),T=c.useRef(null),[p,g]=c.useState(!1),[V,ge]=c.useState(u);c.useEffect(()=>{p&&oe&&b.value!==""&&(O(`search-${e}`,"",!1),O(e,"",!1),pe())},[p]),c.useEffect(()=>{fe(u.reduce((n,r)=>(n[r.value]=r.label,n),{}))},[u]),c.useEffect(()=>{const n=r=>{var h;(h=j.current)!=null&&h.contains(r.target)||g(!1)};return j.current&&document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[j]),c.useEffect(()=>{P&&P(b.value.trim()),m(null)},[b.value]),c.useEffect(()=>{ge(de(u,b.value))},[b.value,u]);const ye=n=>{var r,h,G;switch(n.key){case"ArrowUp":d!==null&&(d<=0?m(null):m(d-1)),p||g(!0),(r=T.current)==null||r.focus();break;case"ArrowDown":d===null?m(0):d>=V.length-1?m(V.length-1):m(d+1),p||g(!0),(h=T.current)==null||h.focus();break;case"Space":U(),(G=T.current)==null||G.focus();break;case"Enter":p&&d!==null&&(n.preventDefault(),R(String(V[d].value)));break;case"Escape":m(null),g(!1);break;case"Tab":m(null),g(!1);break}},R=n=>{let r;i?a.value.includes(n)&&Array.isArray(a.value)?r=a.value.filter(h=>h!==n):r=[...a.value,n]:(r=n,g(!1),m(null),O(`search-${e}`,$[r],!1)),O(e,r)},U=()=>{p||g(!0),k(e,!0)},K=()=>{p?(g(!1),O(`search-${e}`,"",!1)):g(!0),k(e,!0)},be=Array.isArray(a.value)?v??(a.value.length>1&&_?_:F):v??$[a.value];return l.jsxs(_e,{className:t,error:I.error,hideFooter:!o&&y,isOptional:A,label:F,name:`search-${e}`,showError:I.touched&&!!I.error,smallLabel:se,inline:q,description:ue,children:[l.jsxs("div",{className:w(x["multi-select-autocomplete-container"],t),onKeyDown:ye,ref:j,children:[l.jsx(Se,{...d!==null&&{"aria-activedescendant":`option-display-${(W=V[d])==null?void 0:W.value}`},onFocus:U,placeholder:Ve(be),style:{paddingLeft:i&&a.value.length>0?"2.2rem":"1rem"},className:x["multi-select-autocomplete-placeholder-input"],hasError:me.touched&&!!I.error,type:ce,disabled:s,...b,"aria-autocomplete":"list","aria-controls":`list-${e}`,"aria-describedby":`help-${e}`,"aria-expanded":p,"aria-haspopup":"listbox",role:"combobox"}),l.jsxs("div",{"aria-live":"polite","aria-relevant":"text",className:x["visually-hidden"],id:`help-${e}`,children:[i&&`${a.value.length} options sélectionnées`,!i&&!Array.isArray(a.value)&&a.value!==""&&`Option sélectionnée : ${$[a.value]}`,p?`${V.length} options ${b.value===""?"disponibles":"correspondant au texte saisi"}`:"saisissez du texte pour afficher et filtrer les options"]}),l.jsx("select",{hidden:!0,...i&&{multiple:!0},...a,value:a.value||"","data-testid":"select",children:u==null?void 0:u.map(({label:n,value:r})=>l.jsx("option",{value:r,children:n},`option-${r}`))}),l.jsxs("div",{className:x["field-overlay"],children:[!f&&l.jsx(D,{disabled:s,isOpen:p,toggleField:K}),i&&a.value.length>0&&l.jsx("div",{onClick:K,className:x.pellet,children:a.value.length}),p&&l.jsx(H,{className:t,fieldName:e,selectedValues:a.value,filteredOptions:V,setHoveredOptionIndex:m,listRef:T,hoveredOptionIndex:d,selectOption:R,multi:i})]})]}),Array.isArray(a.value)&&!o&&a.value.length>0&&l.jsx(B,{disabled:s,fieldName:e,optionsLabelById:$,selectedOptions:a.value,removeOption:R})]})},ie=C;try{C.displayName="SelectAutocomplete",C.__docgenInfo={description:"",displayName:"SelectAutocomplete",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},isLabelHidden:{defaultValue:null,description:"",name:"isLabelHidden",required:!1,type:{name:"boolean"}},hasLabelLineBreak:{defaultValue:null,description:"",name:"hasLabelLineBreak",required:!1,type:{name:"boolean"}},isOptional:{defaultValue:{value:"false"},description:"",name:"isOptional",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},classNameLabel:{defaultValue:null,description:"",name:"classNameLabel",required:!1,type:{name:"string"}},classNameFooter:{defaultValue:null,description:"",name:"classNameFooter",required:!1,type:{name:"string"}},filterVariant:{defaultValue:null,description:"",name:"filterVariant",required:!1,type:{name:"boolean"}},smallLabel:{defaultValue:{value:"false"},description:"",name:"smallLabel",required:!1,type:{name:"boolean"}},hideFooter:{defaultValue:{value:"false"},description:"",name:"hideFooter",required:!1,type:{name:"boolean"}},inline:{defaultValue:null,description:"",name:"inline",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"",name:"clearButtonProps",required:!1,type:{name:"(ButtonHTMLAttributes<HTMLButtonElement> & { tooltip: string; })"}},ErrorDetails:{defaultValue:null,description:"",name:"ErrorDetails",required:!1,type:{name:"ReactNode"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},hideArrow:{defaultValue:null,description:"",name:"hideArrow",required:!1,type:{name:"boolean"}},hideTags:{defaultValue:{value:"false"},description:"",name:"hideTags",required:!1,type:{name:"boolean"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},multi:{defaultValue:{value:"false"},description:"",name:"multi",required:!1,type:{name:"boolean"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"SelectOption[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},pluralLabel:{defaultValue:null,description:"",name:"pluralLabel",required:!1,type:{name:"string"}},resetOnOpen:{defaultValue:{value:"true"},description:"",name:"resetOnOpen",required:!1,type:{name:"boolean"}},onSearch:{defaultValue:{value:"() => {}"},description:"",name:"onSearch",required:!1,type:{name:"((pattern: string) => void)"}},searchInOptions:{defaultValue:{value:"options => options"},description:"",name:"searchInOptions",required:!1,type:{name:"((options: SelectOption[], pattern: string) => SelectOption[])"}},onReset:{defaultValue:{value:"() => {}"},description:"",name:"onReset",required:!1,type:{name:"(() => void)"}},type:{defaultValue:{value:"text"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"search"'},{value:'"text"'}]}}}}}catch{}const bt={title:"ui-kit/forms/SelectAutocomplete",component:ie},M=t=>l.jsx(ve,{initialValues:t.initialValues,onSubmit:()=>{},children:l.jsx(ie,{...t})}),z={pluralLabel:"Départements",name:"departement",options:[{value:"01",label:"Ain"},{value:"02",label:"Aisne"},{value:"03",label:"Allier"},{value:"04",label:"Alpes-de-Haute-Provence test de libellé très long"},{value:"05",label:"Hautes-Alpes"},{value:"06",label:"Alpes-Maritimes"},{value:"07",label:"Ardèche"},{value:"08",label:"Ardennes"},{value:"09",label:"Ariège"},{value:"10",label:"Aube"},{value:"11",label:"Aude"},{value:"12",label:"Aveyron"},{value:"13",label:"Bouches-du-Rhône"},{value:"14",label:"Calvados"},{value:"15",label:"Cantal"}],initialValues:{departement:"01"},label:"Département",hideFooter:!1,hideTags:!1,isOptional:!1,smallLabel:!1,searchInOptions:Ae},N=M.bind({});N.args=z;const L=M.bind({});L.args={...z,multi:!0,initialValues:{departement:["01","02"]}};const S=M.bind({});S.args={...z,multi:!0,initialValues:{departement:["01","02"]},hideTags:!0};var X,Y,Z;N.parameters={...N.parameters,docs:{...(X=N.parameters)==null?void 0:X.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(Z=(Y=N.parameters)==null?void 0:Y.docs)==null?void 0:Z.source}}};var ee,te,le;L.parameters={...L.parameters,docs:{...(ee=L.parameters)==null?void 0:ee.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(le=(te=L.parameters)==null?void 0:te.docs)==null?void 0:le.source}}};var ae,re,ne;S.parameters={...S.parameters,docs:{...(ae=S.parameters)==null?void 0:ae.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(ne=(re=S.parameters)==null?void 0:re.docs)==null?void 0:ne.source}}};const ht=["Default","Multi","WithoutTags"];export{N as Default,L as Multi,S as WithoutTags,ht as __namedExportsOrder,bt as default};
//# sourceMappingURL=SelectAutocomplete.stories-7157d5f6.js.map
