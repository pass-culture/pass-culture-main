import{R as E,r as l}from"./index-76fb7be0.js";import{R as N,b as y,u as P,g as k,c as K,d as M,e as j,f as H,h as U,i as Y}from"./index-47dfd0dd.js";const{makeDecorator:G,addons:S}=__STORYBOOK_MODULE_PREVIEW_API__,{STORY_ARGS_UPDATED:q}=__STORYBOOK_MODULE_CORE_EVENTS__;var R="storybook/react-router-v6",W="reactRouter",r={CLEAR:`${R}/clear`,NAVIGATION:`${R}/navigation`,STORY_LOADED:`${R}/story-loaded`,ROUTE_MATCHES:`${R}/route-matches`,ACTION_INVOKED:`${R}/action_invoked`,ACTION_SETTLED:`${R}/action_settled`,LOADER_INVOKED:`${R}/loader_invoked`,LOADER_SETTLED:`${R}/loader_settled`},F=()=>{let a=P();return`${a.pathname}${a.search}${a.hash}`},C=E.createContext([]),V=()=>E.useContext(C),B=()=>{let a=l.useRef(0),t=P(),e=H(),[o]=U(),n=Y(),s=V(),d={};o.forEach((i,u)=>{d[u]=i});let c=F(),m=s.map(i=>[i.route.path,i.params]);return i=>{switch(i){case r.STORY_LOADED:{let u={url:c,path:t.pathname,routeParams:e,searchParams:d,routeMatches:m,hash:t.hash,routeState:t.state};return{key:`${r.STORY_LOADED}_${a.current++}`,type:r.STORY_LOADED,data:u}}case r.NAVIGATION:{let u={url:c,path:t.pathname,routeParams:e,searchParams:d,hash:t.hash,routeState:t.state,routeMatches:m,navigationType:n};return{key:`${r.NAVIGATION}_${a.current++}`,type:r.NAVIGATION,data:u}}case r.ROUTE_MATCHES:return{key:`${r.ROUTE_MATCHES}_${a.current++}`,type:r.ROUTE_MATCHES,data:{matches:m}}}}};function z(){let a={};return a.promise=new Promise((t,e)=>{a.resolve=t,a.reject=e}),a}function J(a){let t={};return a.forEach((e,o)=>{if(e instanceof File){t[o]={filename:e.name,filesize:e.size,filetype:e.type};return}t[o]=e}),t}async function L(a){let t=a.clone(),e=t.headers.get("content-type")||"",o;switch(!0){case e.startsWith("text"):o=await t.text();break;case e.startsWith("application/json"):o=await t.json();break;case e.startsWith("multipart/form-data"):case e.startsWith("application/x-www-form-urlencoded"):{o=J(await t.formData());break}default:await t.arrayBuffer().then(n=>n.byteLength)}return o}var Q=({children:a})=>{let t=S.getChannel(),e=P(),[o,n]=l.useState(),[s,d]=l.useState(!1),[c,m]=l.useState([]),i=B(),u=V(),_=l.useRef(z());return l.useLayoutEffect(()=>{n(e)}),l.useEffect(()=>{s&&_.current.resolve()},[s]),l.useEffect(()=>{m(u);let O=setTimeout(()=>{s||(d(!0),t.emit(r.STORY_LOADED,i(r.STORY_LOADED)))},0);return()=>clearTimeout(O)},[s,u]),l.useEffect(()=>{o!==void 0&&o.key!==e.key&&_.current.promise.then(()=>{t.emit(r.NAVIGATION,i(r.NAVIGATION))})},[e]),l.useEffect(()=>{s&&u.length>c.length&&(m(u),t.emit(r.ROUTE_MATCHES,i(r.ROUTE_MATCHES)))},[u]),E.createElement(E.Fragment,null,a)},X=({children:a,routePath:t,routeParams:e,searchParams:o,routeState:n,browserPath:s,hydrationData:d})=>{let c=S.getChannel(),[m,i]=l.useState(),[u,_]=l.useState(0),O=l.useRef();return c.on(q,()=>{_(p=>p+1)}),l.useLayoutEffect(()=>{let p=k(t||"",e),T=new URLSearchParams(o).toString(),D={search:T.length>0?`?${T}`:"",state:n};s!==void 0&&(D.pathname=s),s===void 0&&p!==""&&(D.pathname=p),O.current!==void 0&&Object.assign(D,O.current);let A=K(a),h=M(A,{initialEntries:[D],hydrationData:d});h.subscribe(f=>{O.current=f.location}),i(h)},[u]),m===void 0?null:E.createElement(j,{router:m,fallbackElement:E.createElement(Z,null)})};function Z(){return E.createElement("p",null,"Performing initial data load")}var $=()=>async(a,t)=>{switch(a){case r.ACTION_INVOKED:{let{request:e,params:o,context:n}=t,s={url:e.url,method:e.method,body:await L(e)};return{type:r.ACTION_INVOKED,data:{params:o,request:s,context:n}}}case r.ACTION_SETTLED:return{type:r.ACTION_SETTLED,data:t};case r.LOADER_INVOKED:{let{request:e,params:o,context:n}=t,s={url:e.url,method:e.method,body:L(e)};return{type:r.LOADER_INVOKED,data:{params:o,request:s,context:n}}}case r.LOADER_SETTLED:return{type:r.LOADER_SETTLED,data:t}}},ee=({children:a,browserPath:t,routePath:e="*",routeParams:o,routeHandle:n,searchParams:s,routeState:d,outlet:c,hydrationData:m,action:i,loader:u,errorElement:_,shouldRevalidate:O,routeId:p})=>{let T=S.getChannel(),[D,A]=l.useState([]);N.Provider._context=new Proxy(N.Provider._context??{},{set(x,I,v){return I==="_currentValue"&&A(w=>v!==void 0&&v.matches.length>w.length?v.matches:w),Reflect.set(x,I,v)}});let h=te(c)?c:{element:c},f={element:h.element,handle:h.handle,errorElement:h.errorElement,action:h.action!==void 0?b(T,h.action):void 0,loader:h.loader!==void 0?g(T,h.loader):void 0};return E.createElement(C.Provider,{value:D},E.createElement(X,{routePath:e,routeParams:o,routeState:d,searchParams:s,browserPath:t,hydrationData:m},E.createElement(y,{id:p,path:e,handle:n,action:i!==void 0?b(T,i):void 0,loader:u!==void 0?g(T,u):void 0,shouldRevalidate:O,errorElement:_,element:E.createElement(Q,null,a)},h.element!==void 0&&h.path===void 0&&E.createElement(y,{index:!0,...f}),h.element!==void 0&&E.createElement(y,{path:h.path,...f}))))};function te(a){return a!==null&&typeof a=="object"&&Object.prototype.hasOwnProperty.call(a,"element")}function b(a,t){let e=$();return async function(o){if(t===void 0)return;a.emit(r.ACTION_INVOKED,await e(r.ACTION_INVOKED,o));let n=await t(o);return a.emit(r.ACTION_SETTLED,await e(r.ACTION_SETTLED,n)),n}}function g(a,t){let e=$();return async function(o){if(t===void 0)return;a.emit(r.LOADER_INVOKED,await e(r.LOADER_INVOKED,o));let n=await t(o);return a.emit(r.LOADER_SETTLED,await e(r.LOADER_SETTLED,n)),n}}var oe=G({name:"withRouter",parameterName:W,wrapper:(a,t,{parameters:e={}})=>{let{routePath:o="*",routeParams:n,routeState:s,routeHandle:d,searchParams:c,outlet:m,browserPath:i,loader:u,action:_,errorElement:O,hydrationData:p,shouldRevalidate:T,routeId:D}=e;if(typeof o!="string")throw new Error("React Router decorator : `path` must be a string");if(n!==void 0&&typeof n!="object")throw new Error("React Router decorator : `params` must be an object with strings as values");if(c!==void 0&&typeof c!="object")throw new Error("React Router decorator : `search` must be an object with strings as values");return E.createElement(ee,{browserPath:i,routePath:o,routeParams:n,searchParams:c,routeState:s,routeHandle:d,outlet:m,loader:u,action:_,errorElement:O,hydrationData:p,shouldRevalidate:T,routeId:D},a(t))}});export{oe as D};
//# sourceMappingURL=index-ee67f707.js.map
