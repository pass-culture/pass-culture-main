import{j as e}from"./jsx-runtime-ffb262ed.js";import{c as fe,b as Q,a as ge}from"./formik.esm-96bdd02b.js";import{c as T}from"./index-a587463d.js";import{r as d}from"./index-76fb7be0.js";import{g as ye}from"./getLabelString-a0462018.js";import{B as be,b as he}from"./BaseCheckbox-2cbf2f9d.js";import"./BaseFileInput-5547a44b.js";import{s as ve}from"./stroke-down-f1e965f4.js";import{F as _e}from"./AutocompleteList-31da84c1.js";import"./FieldError-0089fdbc.js";import"./FieldSuccess-31bdacb0.js";import{T as Ve}from"./Tag-2c2f8155.js";import{S as qe}from"./SvgIcon-c0bf369c.js";import{B as xe}from"./BaseInput-a47c473b.js";import"./_commonjsHelpers-de833af9.js";import"./hoist-non-react-statics.cjs-3f8ebaa8.js";import"./BaseRadio-d45b7978.js";import"./full-clear-9268779e.js";import"./Tooltip-383b3df2.js";import"./stroke-error-ed5fe82d.js";import"./stroke-valid-9c345a33.js";import"./stroke-close-3a7bfe9e.js";const Oe="_menu_qqt91_2",Ne="_label_qqt91_21",j={menu:Oe,"menu--no-results":"_menu--no-results_qqt91_17",label:Ne,"option-hovered":"_option-hovered_qqt91_34"},R=({className:a,fieldName:p,maxHeight:l,selectedValues:V,filteredOptions:g,setHoveredOptionIndex:m,listRef:E,hoveredOptionIndex:I,selectOption:q,multi:H})=>e.jsxs("div",{className:T(j.menu,a),style:l?{maxHeight:l}:{},role:"listbox",children:[g.length===0&&e.jsx("span",{className:T({[j["menu--no-results"]]:g.length===0}),children:"Aucun résultat"}),e.jsx("ul",{"data-testid":"list",id:`list-${p}`,ref:E,role:"listbox",children:g.map(({value:i,label:s},b)=>{const h=V.includes(String(i));return e.jsx("li",{"aria-selected":h,"aria-posinset":b+1,"aria-setsize":g.length,className:I===b?j["option-hovered"]:"","data-value":i,"data-selected":h,id:`option-display-${i}`,onMouseEnter:()=>m(b),role:"option",tabIndex:-1,children:H?e.jsx(be,{label:s,checked:h,onChange:()=>{q(String(i))}}):e.jsx("span",{onClick:()=>{q(String(i))},className:T(he["base-checkbox-label"],j.label),children:s})},`option-display-${i}`)})})]});try{R.displayName="OptionsList",R.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[]"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}try{OptionsList.displayName="OptionsList",OptionsList.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[]"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}const Le="_pellet_sn75o_16",x={"multi-select-autocomplete-container":"_multi-select-autocomplete-container_sn75o_2","multi-select-autocomplete-placeholder-input":"_multi-select-autocomplete-placeholder-input_sn75o_8","field-overlay":"_field-overlay_sn75o_12",pellet:Le,"visually-hidden":"_visually-hidden_sn75o_34"},Ae={"multi-select-autocomplete-tags":"_multi-select-autocomplete-tags_1exsd_1"},B=({disabled:a,fieldName:p,optionsLabelById:l,selectedOptions:V,removeOption:g})=>e.jsx("div",{className:Ae["multi-select-autocomplete-tags"],children:V.map(m=>e.jsx(Ve,{label:l[m],closeable:{closeLabel:"Supprimer "+l[m],onClose:()=>{g(m)},disabled:a}},`tag-${p}-${m}`))});try{B.displayName="Tags",B.__docgenInfo={description:"",displayName:"Tags",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},optionsLabelById:{defaultValue:null,description:"",name:"optionsLabelById",required:!0,type:{name:"Record<string, string>"}},selectedOptions:{defaultValue:null,description:"",name:"selectedOptions",required:!0,type:{name:"string[]"}},removeOption:{defaultValue:null,description:"",name:"removeOption",required:!0,type:{name:"(value: string) => void"}}}}}catch{}const Se={"dropdown-indicator":"_dropdown-indicator_1fr35_2"},D=({disabled:a,isOpen:p,toggleField:l})=>e.jsx("button",{onClick:l,className:Se["dropdown-indicator"],type:"button",disabled:a,children:e.jsx(qe,{src:ve,alt:`${p?"Masquer":"Afficher"} les options`,width:"20"})});try{D.displayName="Toggle",D.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}try{Toggle.displayName="Toggle",Toggle.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}const C=({className:a,disabled:p=!1,name:l,hideArrow:V,hideFooter:g=!1,hideTags:m=!1,inline:E,isOptional:I=!1,label:q,maxHeight:H,multi:i=!1,options:s,placeholder:b,pluralLabel:h,smallLabel:se=!1,resetOnOpen:oe=!0,description:ue})=>{var G;const{setFieldTouched:U,setFieldValue:A}=fe(),[t,S]=Q(l),[v,de]=Q(`search-${l}`),[o,c]=d.useState(null),[F,ce]=d.useState({}),k=d.useRef(null),$=d.useRef(null),[u,f]=d.useState(!1),[_,z]=d.useState(s);d.useEffect(()=>{z(s)},[s]),d.useEffect(()=>{u&&oe&&v.value!==""&&A(`search-${l}`,"",!1)},[u]),d.useEffect(()=>{ce(s.reduce((n,r)=>(n[r.value]=r.label,n),{}))},[s]),d.useEffect(()=>{const n=r=>{var y;(y=k.current)!=null&&y.contains(r.target)||f(!1)};return k.current&&document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[k]),d.useEffect(()=>{const n=new RegExp(v.value,"i");z(s.filter(r=>v.value===""||r.label.match(n))),c(null)},[v.value]);const pe=n=>{var r,y,J;switch(n.key){case"ArrowUp":o!==null&&(o<=0?c(null):c(o-1)),u||f(!0),(r=$.current)==null||r.focus();break;case"ArrowDown":o===null?c(0):o>=_.length-1?c(_.length-1):c(o+1),u||f(!0),(y=$.current)==null||y.focus();break;case"Space":K(),(J=$.current)==null||J.focus();break;case"Enter":u&&o!==null&&(n.preventDefault(),w(String(_[o].value)));break;case"Escape":c(null),f(!1);break;case"Tab":c(null),f(!1);break}},w=n=>{let r;i?t.value.includes(n)&&Array.isArray(t.value)?r=t.value.filter(y=>y!==n):r=[...t.value,n]:(r=n,f(!1),c(null),A(`search-${l}`,F[r],!1)),A(l,r)},K=()=>{u||f(!0),U(l,!0)},W=()=>{u?(f(!1),A(`search-${l}`,"",!1)):f(!0),U(l,!0)},me=Array.isArray(t.value)?b??(t.value.length>1&&h?h:q):b??F[t.value];return e.jsxs(_e,{className:a,error:S.error,hideFooter:!m&&g,isOptional:I,label:q,name:`search-${l}`,showError:S.touched&&!!S.error,smallLabel:se,inline:E,description:ue,children:[e.jsxs("div",{className:T(x["multi-select-autocomplete-container"],a),onKeyDown:pe,ref:k,children:[e.jsx(xe,{...o!==null&&{"aria-activedescendant":`option-display-${(G=_[o])==null?void 0:G.value}`},onFocus:K,placeholder:ye(me),style:{paddingLeft:i&&t.value.length>0?"2.2rem":"1rem"},className:x["multi-select-autocomplete-placeholder-input"],hasError:de.touched&&!!S.error,type:"text",disabled:p,...v,"aria-autocomplete":"list","aria-controls":`list-${l}`,"aria-describedby":`help-${l}`,"aria-expanded":u,"aria-haspopup":"listbox",role:"combobox"}),e.jsxs("div",{"aria-live":"polite","aria-relevant":"text",className:x["visually-hidden"],id:`help-${l}`,children:[i&&`${t.value.length} options sélectionnées`,!i&&!Array.isArray(t.value)&&t.value!==""&&`Option sélectionnée : ${F[t.value]}`,u?`${_.length} options ${v.value===""?"disponibles":"correspondant au texte saisi"}`:"saisissez du texte pour afficher et filtrer les options"]}),e.jsx("select",{hidden:!0,...i&&{multiple:!0},...t,"data-testid":"select",children:s==null?void 0:s.map(({label:n,value:r})=>e.jsx("option",{value:r,children:n},`option-${r}`))}),e.jsxs("div",{className:x["field-overlay"],children:[!V&&e.jsx(D,{disabled:p,isOpen:u,toggleField:W}),i&&t.value.length>0&&e.jsx("div",{onClick:W,className:x.pellet,children:t.value.length}),u&&e.jsx(R,{className:a,fieldName:l,maxHeight:H,selectedValues:t.value,filteredOptions:_,setHoveredOptionIndex:c,listRef:$,hoveredOptionIndex:o,selectOption:w,multi:i})]})]}),Array.isArray(t.value)&&!m&&t.value.length>0&&e.jsx(B,{disabled:p,fieldName:l,optionsLabelById:F,selectedOptions:t.value,removeOption:w})]})},ie=C;try{C.displayName="SelectAutocomplete",C.__docgenInfo={description:"",displayName:"SelectAutocomplete",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},isLabelHidden:{defaultValue:null,description:"",name:"isLabelHidden",required:!1,type:{name:"boolean"}},hasLabelLineBreak:{defaultValue:null,description:"",name:"hasLabelLineBreak",required:!1,type:{name:"boolean"}},isOptional:{defaultValue:{value:"false"},description:"",name:"isOptional",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},classNameLabel:{defaultValue:null,description:"",name:"classNameLabel",required:!1,type:{name:"string"}},classNameFooter:{defaultValue:null,description:"",name:"classNameFooter",required:!1,type:{name:"string"}},filterVariant:{defaultValue:null,description:"",name:"filterVariant",required:!1,type:{name:"boolean"}},smallLabel:{defaultValue:{value:"false"},description:"",name:"smallLabel",required:!1,type:{name:"boolean"}},hideFooter:{defaultValue:{value:"false"},description:"",name:"hideFooter",required:!1,type:{name:"boolean"}},inline:{defaultValue:null,description:"",name:"inline",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"",name:"clearButtonProps",required:!1,type:{name:"(ButtonHTMLAttributes<HTMLButtonElement> & { tooltip: string; })"}},ErrorDetails:{defaultValue:null,description:"",name:"ErrorDetails",required:!1,type:{name:"ReactNode"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},hideArrow:{defaultValue:null,description:"",name:"hideArrow",required:!1,type:{name:"boolean"}},hideTags:{defaultValue:{value:"false"},description:"",name:"hideTags",required:!1,type:{name:"boolean"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},multi:{defaultValue:{value:"false"},description:"",name:"multi",required:!1,type:{name:"boolean"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"SelectOption[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},pluralLabel:{defaultValue:null,description:"",name:"pluralLabel",required:!1,type:{name:"string"}},resetOnOpen:{defaultValue:{value:"true"},description:"",name:"resetOnOpen",required:!1,type:{name:"boolean"}}}}}catch{}const Xe={title:"ui-kit/forms/SelectAutocomplete2",component:ie},M=a=>e.jsx(ge,{initialValues:a.initialValues,onSubmit:()=>{},children:e.jsx(ie,{...a})}),P={pluralLabel:"Départements",name:"departement",options:[{value:"01",label:"Ain"},{value:"02",label:"Aisne"},{value:"03",label:"Allier"},{value:"04",label:"Alpes-de-Haute-Provence test de libellé très long"},{value:"05",label:"Hautes-Alpes"},{value:"06",label:"Alpes-Maritimes"},{value:"07",label:"Ardèche"},{value:"08",label:"Ardennes"},{value:"09",label:"Ariège"},{value:"10",label:"Aube"},{value:"11",label:"Aude"},{value:"12",label:"Aveyron"},{value:"13",label:"Bouches-du-Rhône"},{value:"14",label:"Calvados"},{value:"15",label:"Cantal"}],initialValues:{departement:"01"},label:"Département",hideFooter:!1,hideTags:!1,isOptional:!1,smallLabel:!1},O=M.bind({});O.args=P;const N=M.bind({});N.args={...P,multi:!0,initialValues:{departement:["01","02"]}};const L=M.bind({});L.args={...P,multi:!0,initialValues:{departement:["01","02"]},hideTags:!0};var X,Y,Z;O.parameters={...O.parameters,docs:{...(X=O.parameters)==null?void 0:X.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(Z=(Y=O.parameters)==null?void 0:Y.docs)==null?void 0:Z.source}}};var ee,le,te;N.parameters={...N.parameters,docs:{...(ee=N.parameters)==null?void 0:ee.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(te=(le=N.parameters)==null?void 0:le.docs)==null?void 0:te.source}}};var ae,re,ne;L.parameters={...L.parameters,docs:{...(ae=L.parameters)==null?void 0:ae.docs,source:{originalSource:`args => <Formik initialValues={args.initialValues} onSubmit={() => {}}>
    <SelectAutocomplete {...args} />
  </Formik>`,...(ne=(re=L.parameters)==null?void 0:re.docs)==null?void 0:ne.source}}};const Ye=["Default","Multi","WithoutTags"];export{O as Default,N as Multi,L as WithoutTags,Ye as __namedExportsOrder,Xe as default};
//# sourceMappingURL=SelectAutocomplete.stories-69769334.js.map
