import{j as i}from"./jsx-runtime-BYYWji4R.js";import{r as o}from"./index-ClcD9ViR.js";import{A as M}from"./index-D5H1Pu04.js";import{c as k}from"./index.module-DF6qn1Ex.js";import{S as O}from"./Slider-QPxPk_eb.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./index-Chjiymov.js";function P(t){const e=window.devicePixelRatio;return[e*t[0],e*t[1],e*t[2],e*t[3]]}class U{constructor(e){this.context=e}drawArea(e){const a=P(e.coordinates);return this.context.lineWidth=e.width+2,this.context.strokeStyle="white",this.context.strokeRect(...a),this.context.lineWidth=e.width,this.context.strokeStyle=e.color,this.context.strokeRect(...a),this}}const s={"image-editor":"_image-editor_7hlv8_1","image-editor-label":"_image-editor-label_7hlv8_8","image-editor-scale":"_image-editor-scale_7hlv8_14","image-editor-scale-label":"_image-editor-scale-label_7hlv8_21","image-editor-scale-input":"_image-editor-scale-input_7hlv8_30"},m=744;function L(t,e,a){return t<e?e:t>a?a:t}function u(t,e,a,n,l){const g=(t-e)*(l-n)/(a-e)+n;return L(g,n,l)}const h=o.forwardRef(({image:t,canvasHeight:e,canvasWidth:a,cropBorderColor:n,cropBorderHeight:l,cropBorderWidth:g,initialPosition:I={x:.5,y:.5},maxScale:x=4,initialScale:N=1,onChangeDone:d,onImagePainted:v},V)=>{const[j,q]=o.useState(I),[c,F]=o.useState(window.innerWidth),[w,H]=o.useState(N);o.useEffect(()=>{const r=()=>{F(window.innerWidth)};return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]);const y=u(c,0,m,100,e),_=u(c,0,m,100,a),b=u(c,0,m,0,g),B=u(c,0,m,0,l),f=()=>{const r=document.querySelector("canvas"),E=r==null?void 0:r.getContext("2d");if(!E)return;new U(E).drawArea({width:0,color:n,coordinates:[b,B,_,y]})},R=o.useCallback(r=>{q(r)},[]),A=k(()=>d==null?void 0:d(),100);return i.jsxs("div",{className:s["image-editor"],children:[i.jsx(M,{border:[b,B],color:[0,0,0,.2],crossOrigin:"anonymous",height:y,image:t,onImageChange:f,onImageReady:()=>{v==null||v(),f()},onMouseMove:f,onMouseUp:d,onPositionChange:R,position:j,ref:V,scale:Number(w),width:_,"aria-label":"Editeur d'image"}),i.jsx("label",{className:s["image-editor-label"],htmlFor:"scale",children:"Zoom"}),i.jsxs("label",{className:s["image-editor-scale"],htmlFor:"scale",children:[i.jsx("span",{className:s["image-editor-scale-label"],children:"min"}),i.jsx("span",{className:s["image-editor-scale-input"],children:i.jsx(O,{name:"scale",step:.01,max:x>1?x.toFixed(2):1,min:1,displayMinMaxValues:!1,value:w,onChange:r=>{H(Number(r.target.value)),A()}})}),i.jsx("span",{className:s["image-editor-scale-label"],children:"max"})]})]})});h.displayName="ImageEditor";try{h.displayName="ImageEditor",h.__docgenInfo={description:"",displayName:"ImageEditor",props:{image:{defaultValue:null,description:"",name:"image",required:!0,type:{name:"File"}},initialPosition:{defaultValue:{value:"{ x: 0.5, y: 0.5 }"},description:"",name:"initialPosition",required:!1,type:{name:"Position"}},initialScale:{defaultValue:{value:"1"},description:"",name:"initialScale",required:!1,type:{name:"number"}},onChangeDone:{defaultValue:null,description:"",name:"onChangeDone",required:!1,type:{name:"(() => void)"}},onImagePainted:{defaultValue:null,description:"",name:"onImagePainted",required:!1,type:{name:"(() => void)"}},canvasHeight:{defaultValue:null,description:"",name:"canvasHeight",required:!0,type:{name:"number"}},canvasWidth:{defaultValue:null,description:"",name:"canvasWidth",required:!0,type:{name:"number"}},cropBorderColor:{defaultValue:null,description:"",name:"cropBorderColor",required:!0,type:{name:"string"}},cropBorderHeight:{defaultValue:null,description:"",name:"cropBorderHeight",required:!0,type:{name:"number"}},cropBorderWidth:{defaultValue:null,description:"",name:"cropBorderWidth",required:!0,type:{name:"number"}},maxScale:{defaultValue:{value:"4"},description:"",name:"maxScale",required:!1,type:{name:"number"}}}}}catch{}const T=""+new URL("sample-image-B5J5iU8p.jpg",import.meta.url).href,$={title:"components/ImageUploader/ImageEditorInModalUpsertOrEdit",component:h,decorators:[t=>i.jsx(t,{})]},p={args:{canvasHeight:300,canvasWidth:400,cropBorderColor:"#FFF",cropBorderHeight:30,cropBorderWidth:40,image:T}};var W,S,C;p.parameters={...p.parameters,docs:{...(W=p.parameters)==null?void 0:W.docs,source:{originalSource:`{
  args: {
    canvasHeight: 300,
    canvasWidth: 400,
    cropBorderColor: '#FFF',
    cropBorderHeight: 30,
    cropBorderWidth: 40,
    image: sampleImage as unknown as File
  }
}`,...(C=(S=p.parameters)==null?void 0:S.docs)==null?void 0:C.source}}};const D=["Default"];export{p as Default,D as __namedExportsOrder,$ as default};
