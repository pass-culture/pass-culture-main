import{j as r}from"./jsx-runtime-BYYWji4R.js";import{r as o}from"./index-ClcD9ViR.js";import{A as j}from"./index-D5H1Pu04.js";import{S as I}from"./Slider-QPxPk_eb.js";function R(t){const e=window.devicePixelRatio;return[e*t[0],e*t[1],e*t[2],e*t[3]]}class A{constructor(e){this.context=e}drawArea(e){const i=R(e.coordinates);return this.context.lineWidth=e.width+2,this.context.strokeStyle="white",this.context.strokeRect(...i),this.context.lineWidth=e.width,this.context.strokeStyle=e.color,this.context.strokeRect(...i),this}}const n={"image-editor":"_image-editor_7hlv8_1","image-editor-label":"_image-editor-label_7hlv8_8","image-editor-scale":"_image-editor-scale_7hlv8_14","image-editor-scale-label":"_image-editor-scale-label_7hlv8_21","image-editor-scale-input":"_image-editor-scale-input_7hlv8_30"},c=744;function P(t,e,i){return t<e?e:t>i?i:t}function u(t,e,i,s,l){const m=(t-e)*(l-s)/(i-e)+s;return P(m,s,l)}const h=o.forwardRef(({image:t,canvasHeight:e,canvasWidth:i,cropBorderColor:s,cropBorderHeight:l,cropBorderWidth:m,initialPosition:b={x:.5,y:.5},maxScale:g=4,initialScale:C=1,onChangeDone:S},E)=>{const[N,W]=o.useState(b),[d,V]=o.useState(window.innerWidth),[v,q]=o.useState(C);o.useEffect(()=>{const a=()=>{V(window.innerWidth)};return window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[]);const f=u(d,0,c,100,e),x=u(d,0,c,100,i),y=u(d,0,c,0,m),w=u(d,0,c,0,l),p=()=>{const a=document.querySelector("canvas"),_=a==null?void 0:a.getContext("2d");if(!_)return;new A(_).drawArea({width:0,color:s,coordinates:[y,w,x,f]})},B=o.useCallback(a=>{W(a)},[]);return r.jsxs("div",{className:n["image-editor"],children:[r.jsx(j,{border:[y,w],color:[0,0,0,.2],crossOrigin:"anonymous",height:f,image:t,onImageChange:p,onImageReady:p,onMouseMove:p,onMouseUp:S,onPositionChange:B,position:N,ref:E,scale:Number(v),width:x,"aria-label":"Editeur d'image"}),r.jsx("label",{className:n["image-editor-label"],htmlFor:"scale",children:"Zoom"}),r.jsxs("label",{className:n["image-editor-scale"],htmlFor:"scale",children:[r.jsx("span",{className:n["image-editor-scale-label"],children:"min"}),r.jsx("span",{className:n["image-editor-scale-input"],children:r.jsx(I,{name:"scale",step:.01,max:g>1?g.toFixed(2):1,min:1,displayMinMaxValues:!1,value:v,onChange:a=>q(Number(a.target.value))})}),r.jsx("span",{className:n["image-editor-scale-label"],children:"max"})]})]})});h.displayName="ImageEditor";try{h.displayName="ImageEditor",h.__docgenInfo={description:"",displayName:"ImageEditor",props:{image:{defaultValue:null,description:"",name:"image",required:!0,type:{name:"File"}},initialPosition:{defaultValue:{value:"{ x: 0.5, y: 0.5 }"},description:"",name:"initialPosition",required:!1,type:{name:"Position"}},initialScale:{defaultValue:{value:"1"},description:"",name:"initialScale",required:!1,type:{name:"number"}},onChangeDone:{defaultValue:null,description:"",name:"onChangeDone",required:!1,type:{name:"(() => void)"}},canvasHeight:{defaultValue:null,description:"",name:"canvasHeight",required:!0,type:{name:"number"}},canvasWidth:{defaultValue:null,description:"",name:"canvasWidth",required:!0,type:{name:"number"}},cropBorderColor:{defaultValue:null,description:"",name:"cropBorderColor",required:!0,type:{name:"string"}},cropBorderHeight:{defaultValue:null,description:"",name:"cropBorderHeight",required:!0,type:{name:"number"}},cropBorderWidth:{defaultValue:null,description:"",name:"cropBorderWidth",required:!0,type:{name:"number"}},maxScale:{defaultValue:{value:"4"},description:"",name:"maxScale",required:!1,type:{name:"number"}}}}}catch{}export{h as I};
