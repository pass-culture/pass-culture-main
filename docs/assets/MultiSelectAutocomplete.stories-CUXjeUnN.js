import{j as a}from"./jsx-runtime-X2b_N9AH.js";import{c as U,d as k,b as X}from"./formik.esm-CN2zdSWT.js";import{c as E}from"./index-BpvXyOxN.js";import{r as i}from"./index-uCp2LrAq.js";import{B as Y}from"./BaseCheckbox-UK4QUdNW.js";import{g as Z,S as ee}from"./SelectedValuesTags-CglDc_Ga.js";import{s as le}from"./stroke-down-DYCZHAeS.js";import{S as ae}from"./SvgIcon-DP_815J1.js";import{B as te}from"./BaseInput-Bhv-RC4w.js";import{F as re}from"./FieldLayout-uoVs8ton.js";import"./_commonjsHelpers-BosuxZz1.js";import"./stroke-close-C6KSko98.js";import"./full-clear-CvNWe6Ae.js";import"./Button-ijgqDH4C.js";import"./stroke-pass-C0Oiu4_F.js";import"./Tooltip-B_yv2e98.js";import"./useTooltipProps-B8Mr20U1.js";import"./Button.module-CvAyM0-b.js";import"./types-DjX_gQD6.js";import"./FieldError-WpDNj5es.js";import"./stroke-error-BKdTEWJV.js";const ne="_pellet_4iozx_20",se="_menu_4iozx_39",f={"field-overlay":"_field-overlay_4iozx_2","dropdown-indicator":"_dropdown-indicator_4iozx_6",pellet:ne,menu:se,"menu--no-results":"_menu--no-results_4iozx_53"},F=({isOpen:r,onButtonClick:e,filteredOptions:b,maxHeight:u,renderOption:h,displayNumberOfSelectedValues:y=!1,numberOfSelectedOptions:n,className:d,disabled:o,hideArrow:x=!1})=>a.jsxs("div",{className:f["field-overlay"],children:[!x&&a.jsx("button",{onClick:e,className:f["dropdown-indicator"],type:"button",disabled:o,children:a.jsx(ae,{src:le,alt:`${r?"Masquer":"Afficher"} les options`,width:"20"})}),y&&a.jsx("div",{onClick:e,className:f.pellet,children:n}),r&&a.jsxs("div",{className:E(f.menu,d),style:u?{maxHeight:u}:{},role:"listbox",children:[b.length===0&&a.jsx("span",{className:f["menu--no-results"],children:"Aucun résultat"}),b.map(g=>h(g))]})]});try{F.displayName="AutocompleteList",F.__docgenInfo={description:"",displayName:"AutocompleteList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},displayNumberOfSelectedValues:{defaultValue:{value:"false"},description:"",name:"displayNumberOfSelectedValues",required:!1,type:{name:"boolean"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"AutocompleteItemProps[]"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},numberOfSelectedOptions:{defaultValue:null,description:"",name:"numberOfSelectedOptions",required:!1,type:{name:"number"}},onButtonClick:{defaultValue:null,description:"",name:"onButtonClick",required:!0,type:{name:"() => void"}},renderOption:{defaultValue:null,description:"",name:"renderOption",required:!0,type:{name:"(option: AutocompleteItemProps) => ReactNode"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},hideArrow:{defaultValue:{value:"false"},description:"",name:"hideArrow",required:!1,type:{name:"boolean"}}}}}catch{}const B={"multi-select-autocomplete-container":"_multi-select-autocomplete-container_151oo_2","multi-select-autocomplete-placeholder-input":"_multi-select-autocomplete-placeholder-input_151oo_8"},j=({className:r,name:e,hideFooter:b=!1,hideTags:u=!1,isOptional:h=!1,label:y,options:n,onChange:d,maxDisplayOptions:o,maxHeight:x,pluralLabel:g,smallLabel:z=!1,disabled:L=!1,placeholder:R,inline:W,filterMaxLength:G=255})=>{const{setFieldValue:A,handleChange:J,setFieldTouched:O}=U(),[t,N]=k(e),[c,w]=k(`search-${e}`),v=i.useRef(null),[m,V]=i.useState(!1),[S,M]=i.useState(n);i.useEffect(()=>{M(n)},[n]),i.useEffect(()=>{async function l(){!m&&c.value!==""&&await A(`search-${e}`,"",!1)}l()},[m]),i.useEffect(()=>{const l=s=>{var p;(p=v.current)!=null&&p.contains(s.target)||V(!1)};return v.current&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[v]),i.useEffect(()=>{M(n.filter(l=>c.value===""||l.label.toLocaleLowerCase().includes(c.value.toLocaleLowerCase())))},[c.value]);const K=i.useMemo(()=>n.reduce((l,s)=>(l[s.value]=s.label,l),{}),[n]),Q=async()=>{m?(V(!1),await A(`search-${e}`,"",!1)):V(!0),await O(e,!0)};return a.jsxs(re,{className:r,error:N.error,hideFooter:!u&&t.value.length>0?!0:b,isOptional:h,label:y,name:`search-${e}`,showError:N.touched&&!!N.error,smallLabel:z,inline:W,children:[a.jsxs("div",{className:E(B["multi-select-autocomplete-container"],r),ref:v,children:[a.jsx(te,{onFocus:async()=>{m||V(!0),await O(e,!0)},placeholder:R??(t.value.length>1&&g?g:Z(y)),style:{paddingLeft:t.value.length>0?"2.2rem":"1rem"},className:E({[B["multi-select-autocomplete-placeholder-input"]]:t.value.length>0}),hasError:w.touched&&!!w.error,type:"text",disabled:L,"aria-required":!h,...c,maxLength:G}),a.jsx(F,{disabled:L,onButtonClick:Q,isOpen:m,filteredOptions:[...S.slice(0,o??S.length),...o&&o<S.length?[{value:"",label:`${o} résultats maximum. Veuillez affiner votre recherche`,disabled:!0}]:[]],maxHeight:x,displayNumberOfSelectedValues:t.value.length>0,numberOfSelectedOptions:t.value.length,renderOption:({value:l,label:s})=>a.jsx(Y,{label:s,value:l,name:e,onChange:p=>{O(`search-${e}`,!0),J(p),d==null||d(p)},checked:t.value.includes(l)},`${e}-${l}`)})]}),!u&&t.value.length>0&&a.jsx(ee,{disabled:L,fieldName:e,optionsLabelById:K,selectedOptions:t.value,removeOption:l=>A(e,t.value.filter(s=>s!==l))})]})};try{j.displayName="MultiSelectAutocomplete",j.__docgenInfo={description:"",displayName:"MultiSelectAutocomplete",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},isLabelHidden:{defaultValue:null,description:"",name:"isLabelHidden",required:!1,type:{name:"boolean"}},hasLabelLineBreak:{defaultValue:null,description:"",name:"hasLabelLineBreak",required:!1,type:{name:"boolean"}},isOptional:{defaultValue:{value:"false"},description:"",name:"isOptional",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},classNameLabel:{defaultValue:null,description:"",name:"classNameLabel",required:!1,type:{name:"string"}},classNameFooter:{defaultValue:null,description:"",name:"classNameFooter",required:!1,type:{name:"string"}},filterVariant:{defaultValue:null,description:"",name:"filterVariant",required:!1,type:{name:"boolean"}},smallLabel:{defaultValue:{value:"false"},description:"",name:"smallLabel",required:!1,type:{name:"boolean"}},hideFooter:{defaultValue:{value:"false"},description:"",name:"hideFooter",required:!1,type:{name:"boolean"}},inline:{defaultValue:null,description:"",name:"inline",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"",name:"clearButtonProps",required:!1,type:{name:"(ButtonHTMLAttributes<HTMLButtonElement> & { tooltip: string; })"}},ErrorDetails:{defaultValue:null,description:"",name:"ErrorDetails",required:!1,type:{name:"ReactNode"}},hideTags:{defaultValue:{value:"false"},description:"",name:"hideTags",required:!1,type:{name:"boolean"}},maxDisplayOptions:{defaultValue:null,description:"",name:"maxDisplayOptions",required:!1,type:{name:"number"}},maxDisplayOptionsLabel:{defaultValue:null,description:"",name:"maxDisplayOptionsLabel",required:!1,type:{name:"string"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"SelectOption[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((e: ChangeEvent<HTMLInputElement>) => void)"}},pluralLabel:{defaultValue:null,description:"",name:"pluralLabel",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},filterMaxLength:{defaultValue:{value:"255"},description:"",name:"filterMaxLength",required:!1,type:{name:"number"}}}}}catch{}const Se={title:"ui-kit/forms/MultiSelectAutocomplete",component:j,decorators:[r=>a.jsx(X,{initialValues:{departement:["01","02"],"search-departement":""},onSubmit:()=>{},children:a.jsx(r,{})})]},P={pluralLabel:"Départements",name:"departement",options:[{value:"01",label:"Ain"},{value:"02",label:"Aisne"},{value:"03",label:"Allier"},{value:"04",label:"Alpes-de-Haute-Provence test de libellé très long"},{value:"05",label:"Hautes-Alpes"},{value:"06",label:"Alpes-Maritimes"},{value:"07",label:"Ardèche"},{value:"08",label:"Ardennes"},{value:"09",label:"Ariège"},{value:"10",label:"Aube"},{value:"11",label:"Aude"},{value:"12",label:"Aveyron"},{value:"13",label:"Bouches-du-Rhône"},{value:"14",label:"Calvados"},{value:"15",label:"Cantal"}],label:"Département",hideFooter:!1,hideTags:!1,isOptional:!1,smallLabel:!1},_={args:{...P}},q={args:{...P,hideTags:!0}};var C,T,H;_.parameters={..._.parameters,docs:{...(C=_.parameters)==null?void 0:C.docs,source:{originalSource:`{
  args: {
    ...defaultProps
  }
}`,...(H=(T=_.parameters)==null?void 0:T.docs)==null?void 0:H.source}}};var $,I,D;q.parameters={...q.parameters,docs:{...($=q.parameters)==null?void 0:$.docs,source:{originalSource:`{
  args: {
    ...defaultProps,
    hideTags: true
  }
}`,...(D=(I=q.parameters)==null?void 0:I.docs)==null?void 0:D.source}}};const Ee=["Default","WithoutTags"];export{_ as Default,q as WithoutTags,Ee as __namedExportsOrder,Se as default};
