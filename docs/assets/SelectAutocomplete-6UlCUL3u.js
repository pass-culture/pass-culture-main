import{j as l}from"./jsx-runtime-BzUFO2As.js";import{c as y}from"./index-BBzWkpni.js";import{f as G}from"./full-error-BFAmjN4t.js";import{r as a}from"./iframe-bKXaT0FW.js";import{n as I}from"./noop-BjFrJKj1.js";import{S as B}from"./SvgIcon-BLUVFs4W.js";import{f as J}from"./full-down-Cmbtr9nI.js";const P="_menu_1k3zf_1",q={menu:P,"menu--no-results":"_menu--no-results_1k3zf_14","options-item":"_options-item_1k3zf_17","option-hovered":"_option-hovered_1k3zf_22"},C=({className:s,fieldName:f,filteredOptions:t,setHoveredOptionIndex:c,listRef:g,hoveredOptionIndex:b,selectOption:_})=>l.jsx("ul",{className:y(q.menu,s),"data-testid":"list",id:`list-${f}`,ref:g,role:"listbox","aria-label":"options",children:t.length>0?t.map((h,i)=>{const x=b===i;return l.jsx("li",{"aria-selected":x,"aria-posinset":i+1,"aria-setsize":t.length,className:b===i?q["option-hovered"]:"","data-value":h.value,"data-selected":x,id:`option-${f}-${i}`,onMouseEnter:()=>c(i),onFocus:()=>c(i),onClick:()=>{_(h)},role:"option",tabIndex:-1,children:l.jsx("span",{className:y(q["options-item"]),children:h.label})},h.value)}):l.jsx("li",{className:q["menu--no-results"],children:"Aucun résultat"})});try{C.displayName="OptionsList",C.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(option: SelectOption) => void"}}}}}catch{}const o={"select-autocomplete-container":"_select-autocomplete-container_1d72d_2","select-autocomplete-input-container":"_select-autocomplete-input-container_1d72d_8","select-autocomplete-placeholder-input":"_select-autocomplete-placeholder-input_1d72d_12","has-error":"_has-error_1d72d_57","field-overlay":"_field-overlay_1d72d_84","field-layout-label":"_field-layout-label_1d72d_89","field-header-right":"_field-header-right_1d72d_96","field-error":"_field-error_1d72d_103","field-error-icon":"_field-error-icon_1d72d_112","field-layout-input-description":"_field-layout-input-description_1d72d_118"},F={"dropdown-indicator":"_dropdown-indicator_roqvu_1","dropdown-indicator--open":"_dropdown-indicator--open_roqvu_31"},S=({fieldName:s,disabled:f,isOpen:t,toggleField:c})=>l.jsx("button",{onClick:c,className:F["dropdown-indicator"],type:"button","aria-expanded":t,"aria-label":`${t?"Masquer":"Afficher"} les options`,"aria-controls":`list-${s}`,disabled:f,tabIndex:-1,children:l.jsx(B,{className:y({[F["dropdown-indicator--open"]]:t}),src:J})});try{S.displayName="Toggle",S.__docgenInfo={description:"",displayName:"Toggle",props:{fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}const k=a.forwardRef(({className:s,disabled:f=!1,name:t,required:c=!0,requiredIndicator:g="symbol",label:b,options:_,description:h,error:i,onChange:x=()=>I,onBlur:L=()=>I,value:R,onSearch:$=()=>I,searchInOptions:T=(w,p)=>w.filter(d=>d.label.toLowerCase().includes(p.trim().toLowerCase())),shouldResetOnOpen:z=!1},M)=>{const[w,p]=a.useState(""),[d,v]=a.useState(!1),[r,u]=a.useState(null),D=a.useRef(),A=a.useRef(),V=a.useRef(null),N=a.useRef(null),O=a.useRef(null);a.useEffect(()=>{D.current=new Map(_.map(({label:e,value:n})=>[n,e])),A.current=new Map(_.map(({label:e,value:n})=>[e,n]))},[_]);const j=a.useCallback(e=>{V.current?.contains(e.target)||v(!1)},[]);a.useEffect(()=>(V.current&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}),[j]);const m=T(_,w),K=e=>{switch(e.key){case"ArrowUp":if(r!==null){e.preventDefault();const n=(r-1+m.length)%m.length;u(n),O.current?.getElementsByTagName("li")[n]?.scrollIntoView({block:"nearest"})}break;case"ArrowDown":if(E(),r===null)m.length>0&&u(0);else{const n=(r+1)%m.length;u(n),O.current?.getElementsByTagName("li")[n]?.scrollIntoView({block:"nearest"})}break;case"Enter":d&&r!==null&&m[r]&&(e.preventDefault(),m[r]&&H(m[r]));break;case"Escape":e.preventDefault(),d?(u(null),v(!1)):p("");break;case"Tab":u(null),v(!1);break}},H=e=>{p(e.label),x({type:"change",target:{name:t,value:e.value}}),L({type:"blur",target:{name:t,value:e.value}}),v(!1),u(null)},E=()=>{d||(v(!0),z&&(p(""),$("")))},U=()=>{v(!d),N.current?.focus()};return a.useEffect(()=>{const e=R??N.current?.value??"",n=D.current?.get(e);p(n||e)},[R]),a.useImperativeHandle(M,()=>N.current),l.jsxs("div",{children:[l.jsxs("label",{className:y(o["field-layout-label"]),htmlFor:t,children:[b,c&&g==="symbol"&&l.jsx(l.Fragment,{children:" *"}),c&&g==="explicit"&&l.jsx("span",{className:o["field-header-right"],children:"Obligatoire"})]}),h&&l.jsx("span",{id:`description-${t}`,"data-testid":`description-${t}`,className:o["field-layout-input-description"],children:h}),l.jsxs("div",{className:y(o["select-autocomplete-container"],s),ref:V,children:[l.jsxs("div",{className:y(o["select-autocomplete-input-container"]),children:[l.jsx("input",{...r!==null&&{"aria-activedescendant":`option-${t}-${r}`},onClick:E,className:y(o["select-autocomplete-placeholder-input"],{[o["has-error"]]:!!i}),onKeyDown:K,type:"search",disabled:f,"aria-autocomplete":"list","aria-controls":`list-${t}`,id:t,"aria-expanded":d,"aria-haspopup":"listbox","aria-required":c,role:"combobox",value:w,ref:N,name:t,onChange:e=>{u(null),p(e.target.value),$(e.target.value),E()},onBlur:e=>{p(e.target.value),u(null);const n=A.current?.get(e.target.value)??"";L({type:"blur",target:{name:t,value:n}})}}),l.jsx(S,{fieldName:t,disabled:f,isOpen:d,toggleField:U})]}),l.jsx("div",{className:o["field-overlay"],children:d&&l.jsx(C,{className:s,fieldName:t,filteredOptions:m,setHoveredOptionIndex:u,listRef:O,hoveredOptionIndex:r,selectOption:H})})]}),i&&l.jsxs("div",{role:"alert",id:`error-details-${t}`,className:o["field-error"],children:[l.jsx(B,{src:G,className:o["field-error-icon"],alt:"",width:"16"}),l.jsx("span",{className:o["field-error-text"],"data-testid":`error-${t}`,children:i})]})]})});k.displayName="SelectAutocomplete";try{k.displayName="SelectAutocomplete",k.__docgenInfo={description:"",displayName:"SelectAutocomplete",props:{name:{defaultValue:null,description:"Name of the field, used for form submission and accessibility",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"Label displayed above the input",name:"label",required:!0,type:{name:"string | Element"}},options:{defaultValue:null,description:"List of available options",name:"options",required:!0,type:{name:"SelectOption[]"}},description:{defaultValue:null,description:"Helper text displayed below the input",name:"description",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"Disables the input and prevents interaction",name:"disabled",required:!1,type:{name:"boolean"}},required:{defaultValue:{value:"true"},description:"Indicates if the field is required",name:"required",required:!1,type:{name:"boolean"}},requiredIndicator:{defaultValue:{value:"symbol"},description:"What type of required indicator is displayed",name:"requiredIndicator",required:!1,type:{name:"enum",value:[{value:'"symbol"'},{value:'"hidden"'},{value:'"explicit"'}]}},className:{defaultValue:null,description:"Additional CSS class names",name:"className",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Error message to display",name:"error",required:!1,type:{name:"string"}},onChange:{defaultValue:{value:"() => noop"},description:"Called when the selected value changes",name:"onChange",required:!1,type:{name:'((e: CustomEvent<"change">) => void)'}},onBlur:{defaultValue:{value:"() => noop"},description:"Called when the input loses focus",name:"onBlur",required:!1,type:{name:'((e: CustomEvent<"blur">) => void)'}},value:{defaultValue:null,description:"Value of the input",name:"value",required:!1,type:{name:"string"}},onSearch:{defaultValue:{value:"() => noop"},description:"Called when the search input changes",name:"onSearch",required:!1,type:{name:"((pattern: string) => void)"}},searchInOptions:{defaultValue:{value:`(options, pattern) =>
        options.filter((opt) =>
          opt.label.toLowerCase().includes(pattern.trim().toLowerCase())
        )`},description:"Custom function to filter options based on search pattern",name:"searchInOptions",required:!1,type:{name:"((options: SelectOption[], pattern: string) => SelectOption[])"}},shouldResetOnOpen:{defaultValue:{value:"false"},description:"Called when the dropdown opens",name:"shouldResetOnOpen",required:!1,type:{name:"boolean"}}}}}catch{}export{k as S};
