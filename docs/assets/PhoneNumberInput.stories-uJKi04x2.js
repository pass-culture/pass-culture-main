import{j as a}from"./jsx-runtime-BYYWji4R.js";import{g as q,s as V,b as Z,u as ee,a as re,F as ne}from"./index.esm-Z2NZos4s.js";import{c as te,a as ae}from"./index.esm-CIN8MBt5.js";import{i as oe}from"./parseAndValidateFrenchPhoneNumber-6eG9yTOg.js";import{r as f}from"./index-ClcD9ViR.js";import{B as se}from"./BaseInput-Ct79Zm6D.js";import{F as le}from"./FieldError-DaPPKIO7.js";import{c as k}from"./index-DeARc5FM.js";import{f as ie}from"./full-right-Dd3YsyCq.js";import{S as ue}from"./SvgIcon-CyWUmZpn.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./stroke-error-DSZD431a.js";const B=(e,n,t)=>{if(e&&"reportValidity"in e){const r=q(t,n);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},X=(e,n)=>{for(const t in n.fields){const r=n.fields[t];r&&r.ref&&"reportValidity"in r.ref?B(r.ref,t,e):r.refs&&r.refs.forEach(i=>B(i,t,e))}},pe=(e,n)=>{n.shouldUseNativeValidation&&X(e,n);const t={};for(const r in e){const i=q(n.fields,r),l=Object.assign(e[r]||{},{ref:i&&i.ref});if(ce(n.names||Object.keys(e),r)){const o=Object.assign({},q(t,r));V(o,"root",l),V(t,r,o)}else V(t,r,l)}return t},ce=(e,n)=>e.some(t=>t.startsWith(n+"."));function de(e,n,t){return n===void 0&&(n={}),t===void 0&&(t={}),function(r,i,l){try{return Promise.resolve(function(o,h){try{var c=(n.context,Promise.resolve(e[t.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},n,{context:i}))).then(function(p){return l.shouldUseNativeValidation&&X({},l),{values:t.raw?r:p,errors:{}}}))}catch(p){return h(p)}return c&&c.then?c.then(void 0,h):c}(0,function(o){if(!o.inner)throw o;return{values:{},errors:pe((h=o,c=!l.shouldUseNativeValidation&&l.criteriaMode==="all",(h.inner||[]).reduce(function(p,u){if(p[u.path]||(p[u.path]={message:u.message,type:u.type}),c){var y=p[u.path].types,b=y&&y[u.type];p[u.path]=Z(u.path,c,p,u.type,b?[].concat(b,u.message):u.message)}return p},{})),l)};var h,c}))}catch(o){return Promise.reject(o)}}}const x={"select-input-wrapper":"_select-input-wrapper_c04eo_1","select-input":"_select-input_c04eo_1","select-input-icon":"_select-input-icon_c04eo_17","select-input-icon-disabled":"_select-input-icon-disabled_c04eo_96"},S=({disabled:e,options:n,className:t,value:r,onChange:i,onBlur:l})=>a.jsxs("div",{className:k(x["select-input-wrapper"],t),children:[a.jsx(ue,{src:ie,alt:"",className:k(x["select-input-icon"],{[x["select-input-icon-disabled"]]:e}),width:"16"}),a.jsx("select",{className:x["select-input"],id:"countryCode",disabled:e,value:r,onChange:i,onBlur:l,autoComplete:"tel-country-code",children:n.map(o=>a.jsx("option",{value:o.value,label:o.value,children:o.value},o.value))})]});try{S.displayName="CountryCodeSelect",S.__docgenInfo={description:"",displayName:"CountryCodeSelect",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"PhoneCodeSelectOption[]"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(event: ChangeEvent<HTMLSelectElement>) => void"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!0,type:{name:"(event: FocusEvent<HTMLSelectElement, Element>) => void"}}}}}catch{}const w=[{value:"+33"},{value:"+262"},{value:"+508"},{value:"+590"},{value:"+594"},{value:"+596"},{value:"+687"}],me={"+33":"6 12 34 56 78","+262":"692 12 34 56","+508":"55 12 34","+590":"690 00 01 02","+594":"694 00 01 02","+596":"696 00 01 02","+687":"75 12 34"},d={"phone-number-input":"_phone-number-input_1pc75_110","phone-number-input-wrapper":"_phone-number-input-wrapper_1pc75_116","phone-number-input-legend":"_phone-number-input-legend_1pc75_120","phone-number-input-footer":"_phone-number-input-footer_1pc75_125","phone-number-input-error":"_phone-number-input-error_1pc75_131","country-code-select":"_country-code-select_1pc75_138","visually-hidden":"_visually-hidden_1pc75_144","phone-format":"_phone-format_1pc75_156","phone-number-inpus":"_phone-number-inpus_1pc75_164"},g=f.forwardRef(({value:e="",onChange:n,onBlur:t,name:r,disabled:i,maxLength:l=25,error:o,label:h,required:c=!1,asterisk:p=!0,...u},y)=>{const b=f.useId(),j=w[0].value,{prefix:Y,phoneNumber:G}=W(e),[v,I]=f.useState(Y||j),[_,F]=f.useState(G),E=f.useCallback(s=>{const{prefix:m,phoneNumber:Q}=W(s);I(m||j),F(Q)},[j]);f.useEffect(()=>{E(e)},[e,E]);const J=s=>{const m=s.target.value;I(m),n&&n({...s,target:{...s.target,value:m+_,name:r}})},K=s=>{const m=s.target.value;F(m),n&&n({...s,target:{...s.target,value:v+m,name:r}})},O=s=>{t&&t({...s,target:{...s.target,value:v+_,name:r}})};return f.useImperativeHandle(y,()=>{const s=document.createElement("input");return Object.defineProperty(s,"value",{get:()=>v+_,set:m=>{E(m)}}),s.name=r||"",s}),a.jsxs("fieldset",{className:d["phone-number-input-wrapper"],children:[a.jsxs("legend",{className:d["phone-number-input-legend"],children:[h," ",c&&p&&"*"]}),a.jsxs("p",{className:d["phone-format"],id:b,children:["Par exemple : ",me[v]]}),a.jsxs("div",{className:d["phone-number-inpus"],children:[a.jsx("label",{htmlFor:"countryCode",className:d["visually-hidden"],children:"Indicatif téléphonique"}),a.jsx(S,{disabled:!!i,options:w,className:d["country-code-select"],value:v,onChange:J,onBlur:O}),a.jsx("label",{htmlFor:r,className:d["visually-hidden"],children:"Numéro de téléphone"}),a.jsx(se,{disabled:i,hasError:!!o,type:"text",name:r,value:_,onChange:K,onBlur:O,className:d["phone-number-input"],autoComplete:"tel-national",maxLength:l,"aria-describedby":b,...u}),a.jsx("div",{className:d["phone-number-input-footer"],children:o&&a.jsx("div",{className:d["phone-number-input-error"],children:a.jsx(le,{name:r,children:o})})})]})]})});g.displayName="PhoneNumberInput";const W=e=>{const t=w.map(r=>r.value).find(r=>e.startsWith(r));return t?{prefix:t,phoneNumber:e.substring(t.length)}:{prefix:"",phoneNumber:e}};try{g.displayName="PhoneNumberInput",g.__docgenInfo={description:"",displayName:"PhoneNumberInput",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},value:{defaultValue:{value:""},description:"",name:"value",required:!1,type:{name:"string"}},onBlur:{defaultValue:null,description:"",name:"onBlur",required:!1,type:{name:"((e: FocusEvent<HTMLInputElement | HTMLSelectElement, Element>) => void)"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((e: { target: { value: string; name?: string; }; }) => void)"}},maxLength:{defaultValue:{value:"25"},description:"",name:"maxLength",required:!1,type:{name:"number"}},required:{defaultValue:{value:"false"},description:"",name:"required",required:!1,type:{name:"boolean"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"string"}},asterisk:{defaultValue:{value:"true"},description:"",name:"asterisk",required:!1,type:{name:"boolean"}}}}}catch{}const he=({children:e})=>{const n=re({defaultValues:{phone:"+33612345678"},resolver:de(te().shape({phone:ae().required().test({name:"is-phone-valid",message:"Veuillez entrer un numéro de téléphone valide",test:oe})})),mode:"onTouched"});return a.jsx(ne,{...n,children:e})},Ve={title:"ui-kit/formsV2/PhoneNumberInput",component:g,decorators:[e=>a.jsx(he,{children:a.jsx(e,{})})]},H={wrapper:{color:"#666",fontSize:"0.8rem",padding:"0 1rem",backgroundColor:"#f5f5f5",borderRadius:"0.2rem",border:"thin solid #e1e1e1"},pre:{display:"inline-block",padding:"0.5rem"}},N={args:{name:"phone",label:"Custom label for my required field (with validation)"},render:e=>{var l;const{register:n,watch:t,formState:{errors:r}}=ee(),i=t("phone");return a.jsxs(a.Fragment,{children:[a.jsx(g,{...e,...n("phone"),required:!0,error:(l=r.phone)==null?void 0:l.message}),a.jsxs("div",{style:H.wrapper,children:["RAW value: ",a.jsx("pre",{style:H.pre,children:i})]})]})}},P={args:{name:"phone",label:"Phone number input optional",required:!1}},C={args:{name:"phone",label:"Custom label in forced error state",error:"Ce champs comporte une erreur"}};var L,M,R;N.parameters={...N.parameters,docs:{...(L=N.parameters)==null?void 0:L.docs,source:{originalSource:`{
  args: {
    name: 'phone',
    label: 'Custom label for my required field (with validation)'
  },
  render: args => {
    const {
      register,
      watch,
      formState: {
        errors
      }
      // eslint-disable-next-line react-hooks/rules-of-hooks
    } = useFormContext<WrapperFormValues>();
    const phoneNumber = watch('phone');
    return <>
        <PhoneNumberInput {...args} {...register('phone')} required={true} error={errors.phone?.message} />
        <div style={demoStyles['wrapper']}>
          RAW value: <pre style={demoStyles['pre']}>{phoneNumber}</pre>
        </div>
      </>;
  }
}`,...(R=(M=N.parameters)==null?void 0:M.docs)==null?void 0:R.source}}};var T,A,D;P.parameters={...P.parameters,docs:{...(T=P.parameters)==null?void 0:T.docs,source:{originalSource:`{
  args: {
    name: 'phone',
    label: 'Phone number input optional',
    required: false
  }
}`,...(D=(A=P.parameters)==null?void 0:A.docs)==null?void 0:D.source}}};var U,$,z;C.parameters={...C.parameters,docs:{...(U=C.parameters)==null?void 0:U.docs,source:{originalSource:`{
  args: {
    name: 'phone',
    label: 'Custom label in forced error state',
    error: 'Ce champs comporte une erreur'
  }
}`,...(z=($=C.parameters)==null?void 0:$.docs)==null?void 0:z.source}}};const qe=["Default","WithOptional","InErrorState"];export{N as Default,C as InErrorState,P as WithOptional,qe as __namedExportsOrder,Ve as default};
