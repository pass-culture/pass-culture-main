import{j as a}from"./jsx-runtime-iXOPPpZ7.js";import{c as ye,d as G,b as ge}from"./formik.esm-y2tUiI7x.js";import{c as T}from"./index-XNbs-YUW.js";import{r as d}from"./index-7OBYoplD.js";import{F as be,g as ve,d as Ve}from"./Thumb-0wMyg6Dd.js";import{B as _e,b as qe}from"./BaseCheckbox-Q_oD9jls.js";import"./BaseFileInput-L1z9lXK8.js";import"./stroke-offer-vqhbfYxZ.js";import"./FieldError-_oiQB8Lp.js";import"./FieldSuccess-KBPQwpG2.js";import{s as xe}from"./stroke-down-4xbrRvHV.js";import{S as Oe}from"./SvgIcon-UUSKXfrA.js";import{B as Le}from"./BaseInput-GGUmafiT.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./full-next-6FYpialQ.js";import"./Button-UBhUfAOc.js";import"./index-Odt4icYv.js";import"./index-NZh7eYUr.js";import"./Button.module-yhzTO7gk.js";import"./stroke-pass-84wyy11D.js";import"./Tooltip-ehW0-cvy.js";import"./useTooltipProps-Xf9SOXrU.js";import"./BaseRadio-NI7qJIMy.js";import"./full-clear-0L2gsxg_.js";import"./Divider-Bz64tZ7o.js";import"./SubmitButton-1RSlOlg9.js";import"./index-VFMbf6KQ.js";import"./SelectInput-aEEqLxEg.js";import"./typeof-Q9eVcF_1.js";import"./stroke-close-KQNU-49n.js";import"./Banner-K3isowJS.js";import"./shadow-tips-help-vs0tLBP5.js";import"./shadow-tips-warning-og_aO0Ug.js";import"./LinkNodes-A9d8st-V.js";import"./full-link-GGegv9yK.js";import"./InfoBox-0Csbt8ma.js";import"./stroke-error-U5wg3Vd5.js";import"./stroke-valid-qcZpl8lN.js";const J=e=>e.trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Ne=(e,m,t)=>{const p=[];for(let f=0;f<e.length&&!(t&&p.length>=t);f++){const b=e[f].normalizedLabel??J(e[f].label);J(m||"").split(" ").every(v=>b.includes(v))&&p.push(e[f])}return p},Se="_menu_qqt91_2",Ae="_label_qqt91_21",I={menu:Se,"menu--no-results":"_menu--no-results_qqt91_17",label:Ae,"option-hovered":"_option-hovered_qqt91_34"},R=({className:e,fieldName:m,selectedValues:t,filteredOptions:p,setHoveredOptionIndex:f,listRef:b,hoveredOptionIndex:O,selectOption:v,multi:L})=>a.jsxs("div",{className:T(I.menu,e),role:"listbox",children:[p.length===0&&a.jsx("span",{className:T({[I["menu--no-results"]]:p.length===0}),children:"Aucun résultat"}),a.jsx("ul",{"data-testid":"list",id:`list-${m}`,ref:b,role:"listbox",children:p.map(({value:i,label:s},V)=>{const _=(t||[]).includes(String(i));return a.jsx("li",{"aria-selected":_,"aria-posinset":V+1,"aria-setsize":p.length,className:O===V?I["option-hovered"]:"","data-value":i,"data-selected":_,id:`option-display-${i}`,onMouseEnter:()=>f(V),role:"option",tabIndex:-1,children:L?a.jsx(_e,{label:s,checked:_,onChange:()=>{v(String(i))}}):a.jsx("span",{onClick:()=>{v(String(i))},className:T(qe["base-checkbox-label"],I.label),children:s})},`option-display-${i}`)})})]});try{R.displayName="OptionsList",R.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[] | null"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}try{OptionsList.displayName="OptionsList",OptionsList.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[] | null"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}const we="_pellet_1ebpd_16",j={"multi-select-autocomplete-container":"_multi-select-autocomplete-container_1ebpd_2","multi-select-autocomplete-placeholder-input":"_multi-select-autocomplete-placeholder-input_1ebpd_8","field-overlay":"_field-overlay_1ebpd_12",pellet:we},Fe={"dropdown-indicator":"_dropdown-indicator_1fr35_2"},B=({disabled:e,isOpen:m,toggleField:t})=>a.jsx("button",{onClick:t,className:Fe["dropdown-indicator"],type:"button",disabled:e,children:a.jsx(Oe,{src:xe,alt:`${m?"Masquer":"Afficher"} les options`,width:"20"})});try{B.displayName="Toggle",B.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}try{Toggle.displayName="Toggle",Toggle.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}const D=({className:e,disabled:m=!1,name:t,hideArrow:p,hideFooter:f=!1,hideTags:b=!1,inline:O,isOptional:v=!1,label:L,multi:i=!1,options:s,placeholder:V,pluralLabel:_,smallLabel:ne=!1,resetOnOpen:ie=!0,description:se,onSearch:C=()=>{},searchInOptions:oe=N=>N,onReset:ue=()=>{},type:de="text",leftIcon:P})=>{var W;const{setFieldTouched:N,setFieldValue:x}=ye(),[l,S]=G(t),[y,pe]=G(`search-${t}`),[o,c]=d.useState(null),[A,ce]=d.useState({}),w=d.useRef(null),F=d.useRef(null),[u,h]=d.useState(!1),[q,me]=d.useState(s);d.useEffect(()=>{const r=async()=>{await x(`search-${t}`,"",!1),await x(t,"",!1),ue()};u&&ie&&y.value!==""&&r()},[u]),d.useEffect(()=>{ce(s.reduce((r,n)=>(r[n.value]=n.label,r),{}))},[s]),d.useEffect(()=>{const r=n=>{var g;(g=w.current)!=null&&g.contains(n.target)||h(!1)};return w.current&&document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[w]),d.useEffect(()=>{C&&C(y.value.trim()),c(null)},[y.value]),d.useEffect(()=>{me(oe(s,y.value))},[y.value,s]);const fe=async r=>{var n,g,K;switch(r.key){case"ArrowUp":o!==null&&(o<=0?c(null):c(o-1)),u||h(!0),(n=F.current)==null||n.focus();break;case"ArrowDown":o===null?c(0):o>=q.length-1?c(q.length-1):c(o+1),u||h(!0),(g=F.current)==null||g.focus();break;case"Space":await z(),(K=F.current)==null||K.focus();break;case"Enter":u&&o!==null&&(r.preventDefault(),await H(String(q[o].value)));break;case"Escape":c(null),h(!1);break;case"Tab":c(null),h(!1);break}},H=async r=>{let n;i?l.value.includes(r)&&Array.isArray(l.value)?n=l.value.filter(g=>g!==r):n=[...l.value,r]:(n=r,h(!1),c(null),await x(`search-${t}`,A[n],!1)),await x(t,n)},z=async()=>{u||h(!0),await N(t,!0)},U=async()=>{u?(h(!1),await x(`search-${t}`,"",!1)):h(!0),await N(t,!0)},he=Array.isArray(l.value)?V??(l.value.length>1&&_?_:L):V??A[l.value];return a.jsxs(be,{className:e,error:S.error,hideFooter:!b&&f,isOptional:v,label:L,name:`search-${t}`,showError:S.touched&&!!S.error,smallLabel:ne,inline:O,description:se,children:[a.jsxs("div",{className:T(j["multi-select-autocomplete-container"],e),onKeyDown:fe,ref:w,children:[a.jsx(Le,{...o!==null&&{"aria-activedescendant":`option-display-${(W=q[o])==null?void 0:W.value}`},onFocus:z,placeholder:ve(he),style:{paddingLeft:i&&l.value.length>0||P?"2.2rem":"1rem"},className:j["multi-select-autocomplete-placeholder-input"],hasError:pe.touched&&!!S.error,type:de,disabled:m,...y,"aria-autocomplete":"list","aria-controls":`list-${t}`,"aria-describedby":`help-${t}`,"aria-expanded":u,"aria-haspopup":"listbox",role:"combobox",leftIcon:P}),a.jsxs("div",{"aria-live":"polite","aria-relevant":"text",className:"visually-hidden",id:`help-${t}`,children:[i&&`${l.value.length} options sélectionnées`,!i&&!Array.isArray(l.value)&&l.value!==""&&`Option sélectionnée : ${A[l.value]}`,u?`${q.length} options ${y.value===""?"disponibles":"correspondant au texte saisi"}`:"saisissez du texte pour afficher et filtrer les options"]}),a.jsx("select",{hidden:!0,...i&&{multiple:!0},...l,value:l.value||"","data-testid":"select",children:s==null?void 0:s.map(({label:r,value:n})=>a.jsx("option",{value:n,children:r},`option-${n}`))}),a.jsxs("div",{className:j["field-overlay"],children:[!p&&a.jsx(B,{disabled:m,isOpen:u,toggleField:U}),i&&l.value.length>0&&a.jsx("div",{onClick:U,className:j.pellet,children:l.value.length}),u&&a.jsx(R,{className:e,fieldName:t,selectedValues:l.value,filteredOptions:q,setHoveredOptionIndex:c,listRef:F,hoveredOptionIndex:o,selectOption:H,multi:i})]})]}),Array.isArray(l.value)&&!b&&l.value.length>0&&a.jsx(Ve,{disabled:m,fieldName:t,optionsLabelById:A,selectedOptions:l.value,removeOption:H})]})};try{D.displayName="SelectAutocomplete",D.__docgenInfo={description:"",displayName:"SelectAutocomplete",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},isLabelHidden:{defaultValue:null,description:"",name:"isLabelHidden",required:!1,type:{name:"boolean"}},hasLabelLineBreak:{defaultValue:null,description:"",name:"hasLabelLineBreak",required:!1,type:{name:"boolean"}},isOptional:{defaultValue:{value:"false"},description:"",name:"isOptional",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},classNameLabel:{defaultValue:null,description:"",name:"classNameLabel",required:!1,type:{name:"string"}},classNameFooter:{defaultValue:null,description:"",name:"classNameFooter",required:!1,type:{name:"string"}},filterVariant:{defaultValue:null,description:"",name:"filterVariant",required:!1,type:{name:"boolean"}},smallLabel:{defaultValue:{value:"false"},description:"",name:"smallLabel",required:!1,type:{name:"boolean"}},hideFooter:{defaultValue:{value:"false"},description:"",name:"hideFooter",required:!1,type:{name:"boolean"}},inline:{defaultValue:null,description:"",name:"inline",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"",name:"clearButtonProps",required:!1,type:{name:"(ButtonHTMLAttributes<HTMLButtonElement> & { tooltip: string; })"}},ErrorDetails:{defaultValue:null,description:"",name:"ErrorDetails",required:!1,type:{name:"ReactNode"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},hideArrow:{defaultValue:null,description:"",name:"hideArrow",required:!1,type:{name:"boolean"}},hideTags:{defaultValue:{value:"false"},description:"",name:"hideTags",required:!1,type:{name:"boolean"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},multi:{defaultValue:{value:"false"},description:"",name:"multi",required:!1,type:{name:"boolean"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"SelectOption[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},pluralLabel:{defaultValue:null,description:"",name:"pluralLabel",required:!1,type:{name:"string"}},resetOnOpen:{defaultValue:{value:"true"},description:"",name:"resetOnOpen",required:!1,type:{name:"boolean"}},onSearch:{defaultValue:{value:"() => {}"},description:"",name:"onSearch",required:!1,type:{name:"((pattern: string) => void)"}},searchInOptions:{defaultValue:{value:"(options) => options"},description:"",name:"searchInOptions",required:!1,type:{name:"((options: SelectOption[], pattern: string) => SelectOption[])"}},onReset:{defaultValue:{value:"() => {}"},description:"",name:"onReset",required:!1,type:{name:"(() => void)"}},type:{defaultValue:{value:"text"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"search"'},{value:'"text"'}]}},leftIcon:{defaultValue:null,description:"",name:"leftIcon",required:!1,type:{name:"string"}}}}}catch{}const Ie=e=>a.jsx(ge,{initialValues:e.initialValues,onSubmit:()=>{},children:a.jsx(D,{...e})}),yt={title:"ui-kit/forms/SelectAutocomplete",component:Ie},M={pluralLabel:"Départements",name:"departement",options:[{value:"01",label:"Ain"},{value:"02",label:"Aisne"},{value:"03",label:"Allier"},{value:"04",label:"Alpes-de-Haute-Provence test de libellé très long"},{value:"05",label:"Hautes-Alpes"},{value:"06",label:"Alpes-Maritimes"},{value:"07",label:"Ardèche"},{value:"08",label:"Ardennes"},{value:"09",label:"Ariège"},{value:"10",label:"Aube"},{value:"11",label:"Aude"},{value:"12",label:"Aveyron"},{value:"13",label:"Bouches-du-Rhône"},{value:"14",label:"Calvados"},{value:"15",label:"Cantal"}],initialValues:{departement:"01","search-departement":""},label:"Département",hideFooter:!1,hideTags:!1,isOptional:!1,smallLabel:!1,searchInOptions:Ne},k={args:{...M}},$={args:{...M,multi:!0,initialValues:{departement:["01","02"],"search-departement":""}}},E={args:{...M,multi:!0,initialValues:{departement:["01","02"],"search-departement":""},hideTags:!0}};var Q,X,Y;k.parameters={...k.parameters,docs:{...(Q=k.parameters)==null?void 0:Q.docs,source:{originalSource:`{
  args: {
    ...defaultProps
  }
}`,...(Y=(X=k.parameters)==null?void 0:X.docs)==null?void 0:Y.source}}};var Z,ee,te;$.parameters={...$.parameters,docs:{...(Z=$.parameters)==null?void 0:Z.docs,source:{originalSource:`{
  args: {
    ...defaultProps,
    multi: true,
    initialValues: {
      departement: ['01', '02'],
      'search-departement': ''
    }
  }
}`,...(te=(ee=$.parameters)==null?void 0:ee.docs)==null?void 0:te.source}}};var ae,le,re;E.parameters={...E.parameters,docs:{...(ae=E.parameters)==null?void 0:ae.docs,source:{originalSource:`{
  args: {
    ...defaultProps,
    multi: true,
    initialValues: {
      departement: ['01', '02'],
      'search-departement': ''
    },
    hideTags: true
  }
}`,...(re=(le=E.parameters)==null?void 0:le.docs)==null?void 0:re.source}}};const gt=["Default","Multi","WithoutTags"];export{k as Default,$ as Multi,E as WithoutTags,gt as __namedExportsOrder,yt as default};
