import{j as n}from"./jsx-runtime-C_uOM0Gm.js";import{c as v}from"./index-TscbDd2H.js";import{r as l}from"./iframe-CTnXOULQ.js";import{n as C}from"./noop-BjFrJKj1.js";import{F as W}from"./FieldLayout-C8PqBFEm.js";import{f as G}from"./full-down-Cmbtr9nI.js";import{S as J}from"./SvgIcon-CJiY4LCz.js";const P="_menu_1k3zf_1",x={menu:P,"menu--no-results":"_menu--no-results_1k3zf_14","options-item":"_options-item_1k3zf_17","option-hovered":"_option-hovered_1k3zf_22"},S=({className:o,fieldName:p,filteredOptions:t,setHoveredOptionIndex:m,listRef:V,hoveredOptionIndex:_,selectOption:f})=>n.jsx("ul",{className:v(x.menu,o),"data-testid":"list",id:`list-${p}`,ref:V,role:"listbox","aria-label":"options",children:t.length>0?t.map((y,i)=>{const b=_===i;return n.jsx("li",{"aria-selected":b,"aria-posinset":i+1,"aria-setsize":t.length,className:_===i?x["option-hovered"]:"","data-value":y.value,"data-selected":b,id:`option-${p}-${i}`,onMouseEnter:()=>m(i),onFocus:()=>m(i),onClick:()=>{f(y)},role:"option",tabIndex:-1,children:n.jsx("span",{className:v(x["options-item"]),children:y.label})},y.value)}):n.jsx("li",{className:x["menu--no-results"],children:"Aucun rÃ©sultat"})});try{S.displayName="OptionsList",S.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(option: SelectOption) => void"}}}}}catch{}const g={"multi-select-autocomplete-container":"_multi-select-autocomplete-container_1y15t_2","multi-select-autocomplete-input-container":"_multi-select-autocomplete-input-container_1y15t_8","multi-select-autocomplete-placeholder-input":"_multi-select-autocomplete-placeholder-input_1y15t_12","has-error":"_has-error_1y15t_57","field-overlay":"_field-overlay_1y15t_84"},F={"dropdown-indicator":"_dropdown-indicator_roqvu_1","dropdown-indicator--open":"_dropdown-indicator--open_roqvu_31"},k=({fieldName:o,disabled:p,isOpen:t,toggleField:m})=>n.jsx("button",{onClick:m,className:F["dropdown-indicator"],type:"button","aria-expanded":t,"aria-label":`${t?"Masquer":"Afficher"} les options`,"aria-controls":`list-${o}`,disabled:p,tabIndex:-1,children:n.jsx(J,{className:v({[F["dropdown-indicator--open"]]:t}),src:G})});try{k.displayName="Toggle",k.__docgenInfo={description:"",displayName:"Toggle",props:{fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}const L=l.forwardRef(({className:o,disabled:p=!1,name:t,required:m=!0,requiredIndicator:V="symbol",label:_,options:f,description:y,error:i,onChange:b=()=>C,onBlur:j=()=>C,value:R,onSearch:D=()=>C,searchInOptions:B=(w,d)=>w.filter(s=>s.label.toLowerCase().includes(d.trim().toLowerCase())),shouldResetOnOpen:T=!1},z)=>{const[w,d]=l.useState(""),[s,h]=l.useState(!1),[r,u]=l.useState(null),$=l.useRef(),A=l.useRef(),N=l.useRef(null),q=l.useRef(null),O=l.useRef(null);l.useEffect(()=>{$.current=new Map(f.map(({label:e,value:a})=>[a,e])),A.current=new Map(f.map(({label:e,value:a})=>[e,a]))},[f]);const E=l.useCallback(e=>{N.current?.contains(e.target)||h(!1)},[]);l.useEffect(()=>(N.current&&document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}),[E]);const c=B(f,w),M=e=>{switch(e.key){case"ArrowUp":if(r!==null){e.preventDefault();const a=(r-1+c.length)%c.length;u(a),O.current?.getElementsByTagName("li")[a]?.scrollIntoView({block:"nearest"})}break;case"ArrowDown":if(I(),r===null)c.length>0&&u(0);else{const a=(r+1)%c.length;u(a),O.current?.getElementsByTagName("li")[a]?.scrollIntoView({block:"nearest"})}break;case"Enter":s&&r!==null&&c[r]&&(e.preventDefault(),c[r]&&H(c[r]));break;case"Escape":e.preventDefault(),s?(u(null),h(!1)):d("");break;case"Tab":u(null),h(!1);break}},H=e=>{d(e.label),b({type:"change",target:{name:t,value:e.value}}),j({type:"blur",target:{name:t,value:e.value}}),h(!1),u(null)},I=()=>{s||(h(!0),T&&(d(""),D("")))},K=()=>{h(!s),q.current?.focus()};return l.useEffect(()=>{const e=R??q.current?.value??"",a=$.current?.get(e);d(a||e)},[R]),l.useImperativeHandle(z,()=>q.current),n.jsx(W,{className:o,error:i,required:m,requiredIndicator:V,label:_,name:t,showError:!!i,description:y,children:n.jsxs("div",{className:v(g["multi-select-autocomplete-container"],o),ref:N,children:[n.jsxs("div",{className:v(g["multi-select-autocomplete-input-container"]),children:[n.jsx("input",{...r!==null&&{"aria-activedescendant":`option-${t}-${r}`},onClick:I,className:v(g["multi-select-autocomplete-placeholder-input"],{[g["has-error"]]:!!i}),onKeyDown:M,type:"search",disabled:p,"aria-autocomplete":"list","aria-controls":`list-${t}`,id:t,"aria-expanded":s,"aria-haspopup":"listbox","aria-required":m,role:"combobox",value:w,ref:q,name:t,onChange:e=>{u(null),d(e.target.value),D(e.target.value),I()},onBlur:e=>{d(e.target.value),u(null);const a=A.current?.get(e.target.value)??"";j({type:"blur",target:{name:t,value:a}})}}),n.jsx(k,{fieldName:t,disabled:p,isOpen:s,toggleField:K})]}),n.jsx("div",{className:g["field-overlay"],children:s&&n.jsx(S,{className:o,fieldName:t,filteredOptions:c,setHoveredOptionIndex:u,listRef:O,hoveredOptionIndex:r,selectOption:H})})]})})});L.displayName="SelectAutocomplete";try{L.displayName="SelectAutocomplete",L.__docgenInfo={description:"",displayName:"SelectAutocomplete",props:{name:{defaultValue:null,description:"Name of the field, used for form submission and accessibility",name:"name",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"Label displayed above the input",name:"label",required:!0,type:{name:"string | Element"}},options:{defaultValue:null,description:"List of available options",name:"options",required:!0,type:{name:"SelectOption[]"}},description:{defaultValue:null,description:"Helper text displayed below the input",name:"description",required:!1,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"Disables the input and prevents interaction",name:"disabled",required:!1,type:{name:"boolean"}},required:{defaultValue:{value:"true"},description:"Indicates if the field is required",name:"required",required:!1,type:{name:"boolean"}},requiredIndicator:{defaultValue:{value:"symbol"},description:"What type of required indicator is displayed",name:"requiredIndicator",required:!1,type:{name:"enum",value:[{value:'"symbol"'},{value:'"hidden"'},{value:'"explicit"'}]}},className:{defaultValue:null,description:"Additional CSS class names",name:"className",required:!1,type:{name:"string"}},error:{defaultValue:null,description:"Error message to display",name:"error",required:!1,type:{name:"string"}},onChange:{defaultValue:{value:"() => noop"},description:"Called when the selected value changes",name:"onChange",required:!1,type:{name:'((e: CustomEvent<"change">) => void)'}},onBlur:{defaultValue:{value:"() => noop"},description:"Called when the input loses focus",name:"onBlur",required:!1,type:{name:'((e: CustomEvent<"blur">) => void)'}},value:{defaultValue:null,description:"Value of the input",name:"value",required:!1,type:{name:"string"}},onSearch:{defaultValue:{value:"() => noop"},description:"Called when the search input changes",name:"onSearch",required:!1,type:{name:"((pattern: string) => void)"}},searchInOptions:{defaultValue:{value:`(options, pattern) =>
        options.filter((opt) =>
          opt.label.toLowerCase().includes(pattern.trim().toLowerCase())
        )`},description:"Custom function to filter options based on search pattern",name:"searchInOptions",required:!1,type:{name:"((options: SelectOption[], pattern: string) => SelectOption[])"}},shouldResetOnOpen:{defaultValue:{value:"false"},description:"Called when the dropdown opens",name:"shouldResetOnOpen",required:!1,type:{name:"boolean"}}}}}catch{}export{L as S};
