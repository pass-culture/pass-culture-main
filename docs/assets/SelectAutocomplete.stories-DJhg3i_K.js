import{j as a}from"./jsx-runtime-X2b_N9AH.js";import{c as be,d as U,b as ye}from"./formik.esm-CN2zdSWT.js";import{c as z}from"./index-BpvXyOxN.js";import{r as u}from"./index-uCp2LrAq.js";import{g as ve,S as ge}from"./SelectedValuesTags-CglDc_Ga.js";import{B as Ve}from"./BaseInput-Bhv-RC4w.js";import{F as _e}from"./FieldLayout-uoVs8ton.js";import{B as xe,b as qe}from"./BaseCheckbox-UK4QUdNW.js";import{s as Oe}from"./stroke-down-DYCZHAeS.js";import{S as Se}from"./SvgIcon-DP_815J1.js";import"./_commonjsHelpers-BosuxZz1.js";import"./stroke-close-C6KSko98.js";import"./full-clear-CvNWe6Ae.js";import"./Button-ijgqDH4C.js";import"./stroke-pass-C0Oiu4_F.js";import"./Tooltip-B_yv2e98.js";import"./useTooltipProps-B8Mr20U1.js";import"./Button.module-CvAyM0-b.js";import"./types-DjX_gQD6.js";import"./FieldError-WpDNj5es.js";import"./stroke-error-BKdTEWJV.js";const G=t=>t.trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Le=(t,c,e)=>{const p=[];for(let m=0;m<t.length&&!(e&&p.length>=e);m++){const V=t[m].normalizedLabel??G(t[m].label);G(c||"").split(" ").every(b=>V.includes(b))&&p.push(t[m])}return p},Ae="_menu_izhwz_2",we="_label_izhwz_21",F={menu:Ae,"menu--no-results":"_menu--no-results_izhwz_17",label:we,"option-hovered":"_option-hovered_izhwz_34"},B=({className:t,fieldName:c,selectedValues:e,filteredOptions:p,setHoveredOptionIndex:m,listRef:V,hoveredOptionIndex:O,selectOption:b,multi:S})=>a.jsxs("div",{className:z(F.menu,t),role:"listbox",children:[p.length===0&&a.jsx("span",{className:F["menu--no-results"],children:"Aucun résultat"}),a.jsx("ul",{"data-testid":"list",id:`list-${c}`,ref:V,role:"listbox",children:p.map(({value:s,label:f},_)=>{const x=(e||[]).includes(String(s));return a.jsx("li",{"aria-selected":x,"aria-posinset":_+1,"aria-setsize":p.length,className:O===_?F["option-hovered"]:"","data-value":s,"data-selected":x,id:`option-display-${s}`,onMouseEnter:()=>m(_),role:"option",tabIndex:-1,children:S?a.jsx(xe,{label:f,checked:x,onChange:()=>{b(String(s))}}):a.jsx("span",{onClick:()=>{b(String(s))},className:z(qe["base-checkbox-label"],F.label),children:f})},`option-display-${s}`)})})]});try{B.displayName="OptionsList",B.__docgenInfo={description:"",displayName:"OptionsList",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},fieldName:{defaultValue:null,description:"",name:"fieldName",required:!0,type:{name:"string"}},selectedValues:{defaultValue:null,description:"",name:"selectedValues",required:!0,type:{name:"string | string[] | null"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"SelectOption[]"}},setHoveredOptionIndex:{defaultValue:null,description:"",name:"setHoveredOptionIndex",required:!0,type:{name:"(value: number | null) => void"}},listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"Ref<HTMLUListElement>"}},hoveredOptionIndex:{defaultValue:null,description:"",name:"hoveredOptionIndex",required:!0,type:{name:"number | null"}},selectOption:{defaultValue:null,description:"",name:"selectOption",required:!0,type:{name:"(value: string) => void"}},multi:{defaultValue:null,description:"",name:"multi",required:!0,type:{name:"boolean"}}}}}catch{}const Ne="_pellet_aaee5_16",j={"multi-select-autocomplete-container":"_multi-select-autocomplete-container_aaee5_2","multi-select-autocomplete-placeholder-input":"_multi-select-autocomplete-placeholder-input_aaee5_8","field-overlay":"_field-overlay_aaee5_12",pellet:Ne},ke={"dropdown-indicator":"_dropdown-indicator_1rk6u_2"},D=({disabled:t,isOpen:c,toggleField:e})=>a.jsx("button",{onClick:e,className:ke["dropdown-indicator"],type:"button",disabled:t,children:a.jsx(Se,{src:Oe,alt:`${c?"Masquer":"Afficher"} les options`,width:"20"})});try{D.displayName="Toggle",D.__docgenInfo={description:"",displayName:"Toggle",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},toggleField:{defaultValue:null,description:"",name:"toggleField",required:!0,type:{name:"() => void"}}}}}catch{}const H=({className:t,disabled:c=!1,name:e,hideArrow:p,hideFooter:m=!1,hideTags:V=!1,inline:O,isOptional:b=!1,label:S,multi:s=!1,options:f,placeholder:_,pluralLabel:x,smallLabel:re=!1,resetOnOpen:ne=!0,description:se,onSearch:ie=()=>{},searchInOptions:oe=L=>L,onReset:ue=()=>{},type:de="text",leftIcon:C})=>{var W;const{setFieldTouched:L,setFieldValue:q}=be(),[l,A]=U(e),[y,ce]=U(`search-${e}`),[i,d]=u.useState(null),[w,pe]=u.useState({}),N=u.useRef(null),k=u.useRef(null),[o,h]=u.useState(!1),[v,me]=u.useState(f);u.useEffect(()=>{const r=async()=>{await q(`search-${e}`,"",!1),await q(e,"",!1),ue()};o&&ne&&y.value!==""&&r()},[o]),u.useEffect(()=>{pe(f.reduce((r,n)=>(r[n.value]=n.label,r),{}))},[f]),u.useEffect(()=>{const r=n=>{var g;(g=N.current)!=null&&g.contains(n.target)||h(!1)};return N.current&&document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[N]),u.useEffect(()=>{ie(y.value.trim()),d(null)},[y.value]),u.useEffect(()=>{me(oe(f,y.value))},[y.value,f]);const fe=async r=>{var n,g,K;switch(r.key){case"ArrowUp":i!==null&&(i<=0?d(null):d(i-1)),o||h(!0),(n=k.current)==null||n.focus();break;case"ArrowDown":i===null?v.length>0&&d(0):i>=v.length-1?d(v.length-1):d(i+1),o||h(!0),(g=k.current)==null||g.focus();break;case"Space":await M(),(K=k.current)==null||K.focus();break;case"Enter":o&&i!==null&&(r.preventDefault(),await T(String(v[i].value)));break;case"Escape":d(null),h(!1);break;case"Tab":d(null),h(!1);break}},T=async r=>{let n;s?l.value.includes(r)&&Array.isArray(l.value)?n=l.value.filter(g=>g!==r):n=[...l.value,r]:(n=r,h(!1),d(null),await q(`search-${e}`,w[n],!1)),await q(e,n)},M=async()=>{o||h(!0),await L(e,!0)},P=async()=>{o?(h(!1),await q(`search-${e}`,"",!1)):h(!0),await L(e,!0)},he=Array.isArray(l.value)?_??(l.value.length>1&&x?x:S):_??w[l.value];return a.jsxs(_e,{className:t,error:A.error,hideFooter:!V&&m,isOptional:b,label:S,name:`search-${e}`,showError:A.touched&&!!A.error,smallLabel:re,inline:O,description:se,children:[a.jsxs("div",{className:z(j["multi-select-autocomplete-container"],t),onKeyDown:fe,ref:N,children:[a.jsx(Ve,{...i!==null&&{"aria-activedescendant":`option-display-${(W=v[i])==null?void 0:W.value}`},onFocus:M,placeholder:ve(he),style:{paddingLeft:s&&l.value.length>0||C?"2.2rem":"1rem"},className:j["multi-select-autocomplete-placeholder-input"],hasError:ce.touched&&!!A.error,type:de,disabled:c,...y,"aria-autocomplete":"list","aria-controls":`list-${e}`,"aria-describedby":`help-${e}`,"aria-expanded":o,"aria-haspopup":"listbox","aria-required":!b,role:"combobox",leftIcon:C}),a.jsxs("div",{"aria-live":"polite","aria-relevant":"text",className:"visually-hidden",id:`help-${e}`,children:[s&&`${l.value.length} options sélectionnées`,!s&&!Array.isArray(l.value)&&l.value!==""&&`Option sélectionnée : ${w[l.value]}`,o?`${v.length} options ${y.value===""?"disponibles":"correspondant au texte saisi"}`:"saisissez du texte pour afficher et filtrer les options"]}),a.jsx("select",{hidden:!0,...s&&{multiple:!0},...l,value:l.value||"","data-testid":"select",children:f.map(({label:r,value:n})=>a.jsx("option",{value:n,children:r},`option-${n}`))}),a.jsxs("div",{className:j["field-overlay"],children:[!p&&a.jsx(D,{disabled:c,isOpen:o,toggleField:P}),s&&l.value.length>0&&a.jsx("div",{onClick:P,className:j.pellet,children:l.value.length}),o&&a.jsx(B,{className:t,fieldName:e,selectedValues:l.value,filteredOptions:v,setHoveredOptionIndex:d,listRef:k,hoveredOptionIndex:i,selectOption:T,multi:s})]})]}),Array.isArray(l.value)&&!V&&l.value.length>0&&a.jsx(ge,{disabled:c,fieldName:e,optionsLabelById:w,selectedOptions:l.value,removeOption:T})]})};try{H.displayName="SelectAutocomplete",H.__docgenInfo={description:"",displayName:"SelectAutocomplete",props:{label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string | Element"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},maxLength:{defaultValue:null,description:"",name:"maxLength",required:!1,type:{name:"number"}},isLabelHidden:{defaultValue:null,description:"",name:"isLabelHidden",required:!1,type:{name:"boolean"}},hasLabelLineBreak:{defaultValue:null,description:"",name:"hasLabelLineBreak",required:!1,type:{name:"boolean"}},isOptional:{defaultValue:{value:"false"},description:"",name:"isOptional",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},classNameLabel:{defaultValue:null,description:"",name:"classNameLabel",required:!1,type:{name:"string"}},classNameFooter:{defaultValue:null,description:"",name:"classNameFooter",required:!1,type:{name:"string"}},filterVariant:{defaultValue:null,description:"",name:"filterVariant",required:!1,type:{name:"boolean"}},smallLabel:{defaultValue:{value:"false"},description:"",name:"smallLabel",required:!1,type:{name:"boolean"}},hideFooter:{defaultValue:{value:"false"},description:"",name:"hideFooter",required:!1,type:{name:"boolean"}},inline:{defaultValue:null,description:"",name:"inline",required:!1,type:{name:"boolean"}},clearButtonProps:{defaultValue:null,description:"",name:"clearButtonProps",required:!1,type:{name:"(ButtonHTMLAttributes<HTMLButtonElement> & { tooltip: string; })"}},ErrorDetails:{defaultValue:null,description:"",name:"ErrorDetails",required:!1,type:{name:"ReactNode"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},hideArrow:{defaultValue:null,description:"",name:"hideArrow",required:!1,type:{name:"boolean"}},hideTags:{defaultValue:{value:"false"},description:"",name:"hideTags",required:!1,type:{name:"boolean"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"number"}},multi:{defaultValue:{value:"false"},description:"",name:"multi",required:!1,type:{name:"boolean"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"SelectOption[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},pluralLabel:{defaultValue:null,description:"",name:"pluralLabel",required:!1,type:{name:"string"}},resetOnOpen:{defaultValue:{value:"true"},description:"",name:"resetOnOpen",required:!1,type:{name:"boolean"}},onSearch:{defaultValue:{value:"() => {}"},description:"",name:"onSearch",required:!1,type:{name:"((pattern: string) => void)"}},searchInOptions:{defaultValue:{value:"(options) => options"},description:"",name:"searchInOptions",required:!1,type:{name:"((options: SelectOption[], pattern: string) => SelectOption[])"}},onReset:{defaultValue:{value:"() => {}"},description:"",name:"onReset",required:!1,type:{name:"(() => void)"}},type:{defaultValue:{value:"text"},description:"",name:"type",required:!1,type:{name:"enum",value:[{value:'"search"'},{value:'"text"'}]}},leftIcon:{defaultValue:null,description:"",name:"leftIcon",required:!1,type:{name:"string"}}}}}catch{}const Fe=t=>a.jsx(ye,{initialValues:t.initialValues,onSubmit:()=>{},children:a.jsx(H,{...t})}),Ze={title:"ui-kit/forms/SelectAutocomplete",component:Fe},R={pluralLabel:"Départements",name:"departement",options:[{value:"01",label:"Ain"},{value:"02",label:"Aisne"},{value:"03",label:"Allier"},{value:"04",label:"Alpes-de-Haute-Provence test de libellé très long"},{value:"05",label:"Hautes-Alpes"},{value:"06",label:"Alpes-Maritimes"},{value:"07",label:"Ardèche"},{value:"08",label:"Ardennes"},{value:"09",label:"Ariège"},{value:"10",label:"Aube"},{value:"11",label:"Aude"},{value:"12",label:"Aveyron"},{value:"13",label:"Bouches-du-Rhône"},{value:"14",label:"Calvados"},{value:"15",label:"Cantal"}],initialValues:{departement:"01","search-departement":""},label:"Département",hideFooter:!1,hideTags:!1,isOptional:!1,smallLabel:!1,searchInOptions:Le},E={args:{...R}},I={args:{...R,multi:!0,initialValues:{departement:["01","02"],"search-departement":""}}},$={args:{...R,multi:!0,initialValues:{departement:["01","02"],"search-departement":""},hideTags:!0}};var J,Q,X;E.parameters={...E.parameters,docs:{...(J=E.parameters)==null?void 0:J.docs,source:{originalSource:`{
  args: {
    ...defaultProps
  }
}`,...(X=(Q=E.parameters)==null?void 0:Q.docs)==null?void 0:X.source}}};var Y,Z,ee;I.parameters={...I.parameters,docs:{...(Y=I.parameters)==null?void 0:Y.docs,source:{originalSource:`{
  args: {
    ...defaultProps,
    multi: true,
    initialValues: {
      departement: ['01', '02'],
      'search-departement': ''
    }
  }
}`,...(ee=(Z=I.parameters)==null?void 0:Z.docs)==null?void 0:ee.source}}};var ae,te,le;$.parameters={...$.parameters,docs:{...(ae=$.parameters)==null?void 0:ae.docs,source:{originalSource:`{
  args: {
    ...defaultProps,
    multi: true,
    initialValues: {
      departement: ['01', '02'],
      'search-departement': ''
    },
    hideTags: true
  }
}`,...(le=(te=$.parameters)==null?void 0:te.docs)==null?void 0:le.source}}};const ea=["Default","Multi","WithoutTags"];export{E as Default,I as Multi,$ as WithoutTags,ea as __namedExportsOrder,Ze as default};
