<!doctype html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- ----------------------- FONTS ------------------------- -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&family=Poppins:wght@100;300;400;900&family=Roboto+Condensed:wght@100..900&display=swap" rel="stylesheet">

		<title>Modèles d'offres</title>

        <style>
        :root {
            color-scheme: light dark;

            /* mocha */
            --rosewater: #f5e0dc;
            --flamingo: #f2cdcd;
            --pink: #f5c2e7;
            --mauve: #cba6f7;
            --red: #f38ba8;
            --maroon: #eba0ac;
            --peach: #fab387;
            --yellow: #f9e2af;
            --green: #a6e3a1;
            --teal: #94e2d5;
            --sky: #89dceb;
            --sapphire: #74c7ec;
            --blue: #89b4fa;
            --lavender: #b4befe;
            --text: #cdd6f4;
            --subtext1: #bac2de;
            --subtext0: #a6adc8;
            --overlay2: #9399b2;
            --overlay1: #7f849c;
            --overlay0: #6c7086;
            --surface2: #585b70;
            --surface1: #45475a;
            --surface0: #313244;
            --base: #1e1e2e;
            --mantle: #181825;
            --crust: #11111b;

            /* latte */
            --alt-rosewater: #dc8a78;
            --alt-flamingo: #dd7878;
            --alt-pink: #ea76cb;
            --alt-mauve: #8839ef;
            --alt-red: #d20f39;
            --alt-maroon: #e64553;
            --alt-peach: #fe640b;
            --alt-yellow: #df8e1d;
            --alt-green: #40a02b;
            --alt-teal: #179299;
            --alt-sky: #04a5e5;
            --alt-sapphire: #209fb5;
            --alt-blue: #1e66f5;
            --alt-lavender: #7287fd;
            --alt-text: #4c4f69;
            --alt-subtext1: #5c5f77;
            --alt-subtext0: #6c6f85;
            --alt-overlay2: #7c7f93;
            --alt-overlay1: #8c8fa1;
            --alt-overlay0: #9ca0b0;
            --alt-surface2: #acb0be;
            --alt-surface1: #bcc0cc;
            --alt-surface0: #ccd0da;
            --alt-base: #eff1f5;
            --alt-mantle: #e6e9ef;
            --alt-crust: #dce0e8;

            /* nord */
            --nord0: #2e3440;
            --nord1: #3b4252;
            --nord2: #434c5e;
            --nord3: #4c566a;

            --nord4: #d8dee9;
            --nord5: #e5e9f0;
            --nord6: #eceff4;

            --nord7: #8fbcbb;
            --nord8: #88c0d0;
            --nord9: #81a1c1;
            --nord10: #5e81ac;

            --nord11: #bf616a;
            --nord12: #d08770;
            --nord13: #ebcb8b;
            --nord14: #a3be8c;
            --nord15: #b48ead;

            --bg: light-dark(var(--alt-base), var(--nord1));
            --bg-alt: light-dark(var(--alt-mantle), var(--nord2));

            --fg: light-dark(var(--crust), var(--nord5));
            --fg-contrast: light-dark(var(--text), var(--nord3));

            --primary: light-dark(var(--alt-mauve), var(--nord8));
            --secondary: light-dark(var(--alt-sapphire), var(--nord9));
            --secondary-alt: light-dark(var(--alt-green), var(--nord7));

			--mandatory-bg: light-dark(var(--lavender), var(--nord12));
			--mandatory-fg: light-dark(var(--crust), var(--nord0));

			--base-bg: light-dark(var(--blue), var(--nord13));
			--base-fg: light-dark(var(--crust), var(--nord0));

			--inherited-bg: light-dark(var(--mauve), var(--nord14));
			--inherited-fg: light-dark(var(--crust), var(--nord0));

			--own-bg: light-dark(var(--teal), var(--nord15));
			--own-fg: light-dark(var(--crust), var(--nord0));
        }

        html {
            background: var(--bg);
            scroll-behavior: smooth;
        }

        body {
            display: grid;
            grid-template-areas:
                "nav-title main-title ."
                "nav main .";
            grid-template-columns: 1fr auto 1fr;
            grid-template-rows: 15rem auto;

            color: var(--fg);

            font-family: "Roboto Condensed";
            font-size: 100%;

            margin: 0;
            padding: 0;
        }

        main {
            grid-area: main;
        }

        main section:first-of-type {
            max-width: 90ch;

            margin-bottom: 4rem;
        }

        main section:first-of-type h2 {
            margin: 0 0 3rem 0;
            text-align: left;
        }

        main section:first-of-type h3 {
            text-align: left;
        }

        main section:first-of-type ol {
            display: inherit;
        }

        p {
            text-align: justify;
        }

        h1:has(+nav) {
            grid-area: nav-title;

            display: flex;
            margin: auto 2rem;

            color: var(--primary);

            font-family: "Poppins";
            font-weight: 300;
        }

        nav {
            grid-area: nav;

            display: grid;
            grid-template-rows: 15rem auto;
        }

        nav ul {
            margin: 0 2rem;
            padding: 0;

            list-style: none;
        }

        nav ul li {
            margin: 0;
            padding: 0;
        }

        nav ul li a {
            text-decoration: none;

            font-family: "Poppins";
            font-size: 0.9rem;
            font-weight: 300;

            color: var(--primary);
        }

        nav ul li a:hover {
            color: var(--secondary);
        }

        nav ul li a:visited {
            color: var(--secondary-alt);
        }

        nav h2 {
            font-family: "Poppins";
            font-size: 2rem;
            font-weight: 100;

            display: flex;
            margin: auto 2rem;

            color: var(--primary);
        }

        h1:has(+main) {
            grid-area: main-title;

            font-family: "Poppins";
            font-size: 4rem;
            font-weight: 900;

            text-align: center;

            background-image: linear-gradient(120deg, var(--primary), var(--secondary));
            background-clip: text;
            color: transparent;

            display: flex;
            margin: auto;
        }

        h2 {
            font-size: 2rem;
            font-weight: 900;

            background-image: linear-gradient(240deg, var(--primary), var(--secondary));
            background-clip: text;
            color: transparent;

            margin: 0.5rem;
        }

        h2, h3 {
            text-align: center;
        }

        h3 {
            color: var(--secondary);
        }

        article {
            display: grid;
            grid-template-areas:
                "title title"
                "required optional"
                "required-list optional-list" ;
            grid-template-columns: 1fr 1fr;

            background: var(--bg-alt);

            border: 1px solid var(--fg-contrast);
            border-radius: 0.5rem;

            margin: 0 0 2rem 0;
			padding-bottom: 1rem;
        }

        header {
            grid-area: title;

            background: var(--fg-contrast);

            border-radius: 0.5rem 0.5rem 0 0;

            padding: 0 1rem;

            display: grid;
            grid-template-areas: ". title-content icon";
            grid-template-columns: 2rem auto 2rem;
        }

        header h2 {
            grid-area: title-content;
        }

        header a {
            grid-area: icon;

            display: flex;
            margin: auto;
        }

        h3:first-of-type {
            grid-area: required;
        }

        h3:first-of-type + ol {
            grid-area: required-list;
        }

        h3:last-of-type {
            grid-area: optional;
        }

        h3:last-of-type + ol {
            grid-area: optional-list;
        }

		ol {
            display: flex;
            flex-direction: column;

            margin: 0 auto;
			padding: 0 2rem;

			list-style: none;
		}

		li {
			margin: 0.25rem 0;
		}

        @media (prefers-color-scheme: dark) {
            li {
                font-weight: 500;
            }
        }

		li svg {
			vertical-align: bottom;
		}

		li.mandatory {
			background: var(--mandatory-bg);
			color: var(--mandatory-fg);
		}

		li.base {
			background: var(--base-bg);
			color: var(--base-fg);
		}

		li.inherited {
			background: var(--inherited-bg);
			color: var(--inherited-fg);
		}

		li.own {
			background: var(--own-bg);
			color: var(--own-fg);
		}

		li.mandatory, li.base, li.inherited, li.own {
			padding: 2px 0.25rem;
			border-radius: 0.25rem;
		}

		ol li ol:has(li.or) {
			list-style: disc;
		}

		ol li ol {
			background: var(--bg-alt);
			border-radius: 0.25rem;
			list-style: lower-alpha;
			padding-top: 0.25rem;
			padding-bottom: 0.25rem;
		}

		ol li ol li {
			font-family: "Manrope";
            font-size: 0.9rem;
			margin: 0;
		}

		li {
			color: var(--fg);
		}

        @media (max-width: 1300px) {
            h1:has(+nav), nav {
                display: none;
            }
        }

        @media (max-width: 600px) {
            body {
                grid-template-columns: 0 auto 0;
                padding: 1rem;
            }

            article {
                grid-template-areas:
                "title        " 
                "required     "
                "required-list"
                "optional     "
                "optional-list";
            grid-template-columns: auto;
            }

            article header {
                grid-template-areas:
                    ". title-content ."
                    ". icon .";
                grid-template-columns: 0.25rem auto 0.25rem;
                grid-template-rows: auto min-content;

                padding: 0;
            }

            article header a {
                padding: 0.5rem;
            }
        }
        </style>
	</head>

	<body>
        <h1>Index</h1>
		<nav>
            <ul>
            {% for schema in schemas %}
            <li><a href=#{{ schema.subcategory.id }}>{{ schema.subcategory.pro_label }}</a></li>
            {% endfor %}
            </ul>
		</nav>

        <h1>Modèles d'offres</h1>
		<main>
        <section>
            <h2>Présentation du document</h2>

            <p>
            Chacune des sections suivantes décrits les informations qui
            définissent une offre d'une sous-catégorie. Elles-ci sont
            divisées en deux : <em>obligatoires</em> et <em>optionnelles</em>.
            </p>

            <h3>Niveau de détails</h3>

            <p>
            Ce document n'a pas vocation à rentrer dans les détails de chaque
            définition : seuls les noms des champs sont remontés, pas leur type
            ou les éventuelles contraintes qui y sont liées. Par exemple,
            on retrouvera uniquement <code>description</code> sans préciser
            qu'il s'agit de texte qui a (probablement) une longueur maximale.
            </p>

            <p><em>L'objectif ici est de donner un aperçu, pas une
                spécification.</em></p>

            <h3>Code couleur</h3>

            <p>
            Chaque information (nom, description, etc.) est colorée afin de
            mieux comprendre comment l'ensemble s'est construit. Cela permet,
            par exemple, de tout de suite identifier les informations qui
            sont communes à toutes les offres, celles qui ne sont communes qu'à
            un sous-ensemble ou encore celles qui sont propres à cette
            sous-catégorie.
            </p>

            <p>
            <em>Cette construction est arbitraire et peut évoluer.</em>
            </p>

            <p>
            <em>Ce code couleur a un intérêt produit faible (sans être
                complètement nul) et est avant tout utile d'une point de
            vue technique.</em>
            </p>

            <ol>
                <li class="mandatory">informations obligatoires pour toutes les sous-catégories<li>
                <li class="base">informations optionnelles pour toutes les sous-catégories (sauf rares exceptions)<li>
                <li class="inherited">informations partagées par un sous-ensemble<li>
                <li class="own">informations propres<li>
            </ol>

            <h3>Données complexes</h3>

            <p>
            Certaines informations sont des données simples : une date, du
            texte, etc. D'autres contiennent un ensemble de données, le cas le
            plus courant ici est <code>extra_data</code> qui regroupe un genre
            musical, un nom d'interprète, etc.
            </p>

            <p>
            Ces sous-informations apparaissent sous une forme de liste
            numérotée par des lettres. Lorsqu'une information est
            optionnelle, elle est préfixée par <code>[opt]</code>.
            </p>

            <h3>Plusieurs options (retrait de billet)</h3>

            <p>
            Par soucis de lisibilité, le cas des retaits de billets a été
            simplifié en une liste non ordonnée de noms de modèles (tels que
            définis dans le code). Chacun modélise un ensemble de valeurs
            possibles.
            </p>

        </section>

        <section>
		{% for schema in schemas %}
        <article>
            <header>
                <h2 id="{{ schema.subcategory.id }}">{{ schema.subcategory.pro_label }}</h2>
                <a href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-up" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M7.646 2.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 3.707 2.354 9.354a.5.5 0 1 1-.708-.708z"/>
                        <path fill-rule="evenodd" d="M7.646 6.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 7.707l-5.646 5.647a.5.5 0 0 1-.708-.708z"/>
                    </svg>
                </a>
            </header>

            <h3>Informations obligatoires</h3>
            <ol>
                {% for field in schema.properties.required %}
                {% if field.components %}
                <li class="{{ field.origin.value.lower() }}">
					<details>
						<summary>{{ field.name }}</summary>
						<ol>
							{% for nested_field in field.components %}
								{% if nested_field.components %}
									<li class="or">
											{{ "[opt]" if nested_field.optional else "" }}
											{{ nested_field.name }}
									</li>
								{% else %}
								<li>
									{{ "[opt]" if nested_field.optional else "" }}
									{{ nested_field.name }}
								</li>
								{% endif %}
							{% endfor %}
						</ol>
					</details>
                </li>
                {% else %}
				<li class="{{ field.origin.value.lower() }}">{{ field.name }}</li>
                {% endif %}
                {% endfor %}
            </ol>

            <h3>Informations optionnelles</h3>
            <ol>
                {% for field in schema.properties.optional %}
                {% if field.components %}
                <li class="{{ field.origin.value.lower() }}">
					<details>
						<summary>{{ field.name }}</summary>
						<ol>
							{% for nested_field in field.components %}
								{% if nested_field.components %}
									<li class="or">
											{{ "[opt]" if nested_field.optional else "" }}
											{{ nested_field.name }}
									</li>
								{% else %}
								<li>
									{{ "[opt]" if nested_field.optional else "" }}
									{{ nested_field.name }}
								</li>
								{% endif %}
							{% endfor %}
						</ol>
					</details>
                </li>
                {% else %}
				<li class="{{ field.origin.value.lower() }}">{{ field.name }}</li>
                {% endif %}
                {% endfor %}
            </ol>
        </article>
        </section>
		{% endfor %}
		</main>
	</body>
</html>
