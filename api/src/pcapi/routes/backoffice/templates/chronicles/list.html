{% extends "layouts/list.html" %}
{% from "components/forms.html" import build_filters_form_ng with context %}
{% from "components/collapsable_text.html" import collapsable_text with context %}
{% from "components/dynamic/modal.html" import build_static_htmx_modal with context %}
{% from "components/dynamic/modal.html" import build_dynamic_modal with context %}
{% set rows_count = rows.total %}
{% set pagination = True %}
{% block title %}Chroniques{% endblock %}
{% block search_block %}{{ build_filters_form_ng(form, dst) }}{% endblock %}
{% block table_header %}
  {% if has_permission("MANAGE_CHRONICLE") %}<th>Actions</th>{% endif %}
  <th>ID</th>
  <th>Titres des œuvres</th>
  <th>Contenu</th>
  <th>Date de création</th>
  <th>Publiée</th>
  <th>Diffusibilité RS</th>
{% endblock table_header %}
{% block table_body %}
  {% with chronicles=rows.items %}
    {% include "chronicles/list_rows.html" %}
  {% endwith %}
{% endblock table_body %}
{% block after_table %}
  {% for chronicle in rows.items %}
    {{ build_static_htmx_modal("publish-chronicle-modal-" + chronicle.id|string, "#chronicle-row-" + chronicle.id|string, url_for('backoffice_web.chronicles.publish_chronicle', chronicle_id=chronicle.id) , chronicle_publication_form, "Publier la chronique " + chronicle.id|string, "Publier") }}
    {{ build_static_htmx_modal("unpublish-chronicle-modal-" + chronicle.id|string, "#chronicle-row-" + chronicle.id|string, url_for('backoffice_web.chronicles.unpublish_chronicle', chronicle_id=chronicle.id) , chronicle_publication_form, "Dépublier la chronique " + chronicle.id|string, "Dépublier") }}
    {{ build_dynamic_modal(url_for('backoffice_web.chronicles.get_update_chronicle_content_form', chronicle_id=chronicle.id) , "update-chronicle-content-" + chronicle.id|string) }}
  {% endfor %}
{% endblock after_table %}
