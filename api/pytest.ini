[pytest]
addopts=
    --verbose
    --tb=short
    -Werror
    # Raised by SQLAlchemy (>=1.3.17, see https://github.com/sqlalchemy/sqlalchemy/commit/916e1fea25afcd07fa1d1d2f72043b372cd02223) because of pytest-flask-sqlalchemy.
    # FIXME (dbaty, 2020-10-21): Follow https://github.com/jeancochrane/pytest-flask-sqlalchemy/issues/36
    # for a possible fix.
    -W"ignore:Reset agent is not active:sqlalchemy.exc.SAWarning"
    # FIXME (jsdupuis, 2022-04-14): can be removed when we use flask-sqlalchemy >=2.5
    # (https://github.com/pallets-eco/flask-sqlalchemy/commit/3565f0587519168c5ea4301f6e4bfba8c2ac4dee)
    -W"ignore:'__ident_func__' is deprecated and will be removed in Werkzeug 2.1.:DeprecationWarning"
    # FIXME (rpaoloni, 2022-04-19): some of our dependencies (swift and rq) use `distutils.version.StrictVersion`,
    # which emits a deprecation warnings with setuptools >=59.6.0. Remove this when we update or remove those
    # dependencies.
    -W"ignore:distutils Version classes are deprecated. Use packaging.version instead.:DeprecationWarning"
    # FIXME (jsdupuis, 2022-04-25): flask_admin validators uses tuples for flags (eg. field_flags = ('unique', )),
    # which emits deprecation warnings in wtforms >=3.0.0a1.
    # Remove this when we remove flask_admin
    -W"ignore:Flags should be stored in dicts and not in tuples. The next version of WTForms will abandon support for flags in tuples.:DeprecationWarning"
testpaths=tests
norecursedirs=.git venv/ .pytest_cache/
# Synchronize these globs with `TEST_FILES` in CircleCI configuration
python_files=*_test.py test_*.py tests.py
python_classes=*Test
python_functions=test_* when_* expect_* should_*
env_files=local_test_env_file
mocked-sessions=pcapi.models.db.session
junit_family=xunit1